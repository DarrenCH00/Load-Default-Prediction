{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# FIT5202 Assignment 1 : Analysing eCommerce Data\n",
    "\n",
    "## Table of Contents  \n",
    "* \n",
    "    * [Part 1 : Working with RDD](#part-1)  \n",
    "        * [1.1 Data Preparation and Loading](#1.1)  \n",
    "        * [1.2 Data Partitioning in RDD](#1.2)  \n",
    "        * [1.3 Query/Analysis](#1.3)  \n",
    "    * [Part 2 : Working with DataFrames](#2-dataframes)  \n",
    "        * [2.1 Data Preparation and Loading](#2-dataframes)  \n",
    "        * [2.2 Query/Analysis](#2.2)  \n",
    "    * [Part 3 :  RDDs vs DataFrame vs Spark SQL](#part-3)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Part 1 : Working with RDDs <a class=\"anchor\" name=\"part-1\"></a>\n",
    "## 1.1 Working with RDD\n",
    "In this section, you will need to create RDDs from the given datasets, perform partitioning in these RDDs and use various RDD operations to answer the queries for retail analysis. \n",
    "\n",
    "### 1.1.1 Data Preparation and Loading <a class=\"anchor\" name=\"1.1\"></a>\n",
    "Write the code to create a SparkContext object using SparkSession. To create a SparkSession you first need to build a SparkConf object that contains information about your application, use Melbourne time as the session timezone. Give an appropriate name for your application and run Spark locally with as many working processors as logical cores on your machine. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark import SparkConf\n",
    "\n",
    "master = \"local[*]\"\n",
    "\n",
    "app_name = \"Assignment 1\"\n",
    "\n",
    "spark_conf = SparkConf().setMaster(master).setAppName(app_name)\n",
    "\n",
    "from pyspark import SparkContext # Spark\n",
    "from pyspark.sql import SparkSession # Spark SQL\n",
    "\n",
    "spark = SparkSession.builder.config(conf=spark_conf).config('spark.sql.session.timeZone', 'Australia/Melbourne').getOrCreate()\n",
    "\n",
    "sc = spark.sparkContext\n",
    "sc.setLogLevel('ERROR')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1.1.2 Load all CSV files into RDDs."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "app_data_rdd = sc.textFile('application_data.csv')\n",
    "prev_data_rdd = sc.textFile('previous_application.csv')\n",
    "value_dict_rdd = sc.textFile('value_dict.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1.1.3 For each RDD, remove the header rows and display the total count and first 10 records. (Hint: You can use csv.reader to parse rows into RDDs.)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The total count for appilication data is 172591\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[['118100',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'Y',\n",
       "  'Y',\n",
       "  '1',\n",
       "  '247500.0',\n",
       "  '667237.5',\n",
       "  '52848.0',\n",
       "  '576000.0',\n",
       "  '2',\n",
       "  '4',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.018801',\n",
       "  '-11258',\n",
       "  '-1596',\n",
       "  '13.0',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '12',\n",
       "  '3.0',\n",
       "  'FRIDAY',\n",
       "  '8',\n",
       "  '28',\n",
       "  '0.60994226',\n",
       "  '0.5884348',\n",
       "  '',\n",
       "  '-733.0',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  ''],\n",
       " ['110133',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '2',\n",
       "  '112500.0',\n",
       "  '1374480.0',\n",
       "  '49500.0',\n",
       "  '1125000.0',\n",
       "  '8',\n",
       "  '1',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.006233',\n",
       "  '-11044',\n",
       "  '-942',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '16',\n",
       "  '4.0',\n",
       "  'MONDAY',\n",
       "  '10',\n",
       "  '42',\n",
       "  '0.7081764',\n",
       "  '0.6865754',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  ''],\n",
       " ['110215',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '0',\n",
       "  '166500.0',\n",
       "  '545040.0',\n",
       "  '26640.0',\n",
       "  '450000.0',\n",
       "  '2',\n",
       "  '1',\n",
       "  '6',\n",
       "  '6',\n",
       "  '0.032561',\n",
       "  '-17115',\n",
       "  '-581',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '19',\n",
       "  '1.0',\n",
       "  'MONDAY',\n",
       "  '14',\n",
       "  '22',\n",
       "  '0.49497995',\n",
       "  '0.58477587',\n",
       "  '0.47225335',\n",
       "  '-1598.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '1.0',\n",
       "  '0.0',\n",
       "  '3.0'],\n",
       " ['194051',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'N',\n",
       "  '0',\n",
       "  '112500.0',\n",
       "  '900000.0',\n",
       "  '24750.0',\n",
       "  '900000.0',\n",
       "  '2',\n",
       "  '1',\n",
       "  '2',\n",
       "  '6',\n",
       "  '0.015221',\n",
       "  '-17855',\n",
       "  '-5470',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '8',\n",
       "  '2.0',\n",
       "  'FRIDAY',\n",
       "  '15',\n",
       "  '30',\n",
       "  '',\n",
       "  '0.59620756',\n",
       "  '0.6195277',\n",
       "  '-734.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '1.0'],\n",
       " ['110368',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '0',\n",
       "  '261000.0',\n",
       "  '1237684.5',\n",
       "  '47272.5',\n",
       "  '1138500.0',\n",
       "  '5',\n",
       "  '4',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.020713',\n",
       "  '-22818',\n",
       "  '365243',\n",
       "  '',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '18',\n",
       "  '2.0',\n",
       "  'FRIDAY',\n",
       "  '10',\n",
       "  '31',\n",
       "  '',\n",
       "  '0.64156574',\n",
       "  '0.3996756',\n",
       "  '-979.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0'],\n",
       " ['110498',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'N',\n",
       "  '0',\n",
       "  '157500.0',\n",
       "  '179865.0',\n",
       "  '11133.0',\n",
       "  '148500.0',\n",
       "  '5',\n",
       "  '1',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.00496',\n",
       "  '-21183',\n",
       "  '365243',\n",
       "  '',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '18',\n",
       "  '2.0',\n",
       "  'THURSDAY',\n",
       "  '14',\n",
       "  '31',\n",
       "  '',\n",
       "  '0.14626195',\n",
       "  '0.5064842',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '4.0'],\n",
       " ['110561',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '1',\n",
       "  '157500.0',\n",
       "  '1256400.0',\n",
       "  '36864.0',\n",
       "  '900000.0',\n",
       "  '8',\n",
       "  '4',\n",
       "  '6',\n",
       "  '6',\n",
       "  '0.018029',\n",
       "  '-9537',\n",
       "  '-182',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '10',\n",
       "  '2.0',\n",
       "  'TUESDAY',\n",
       "  '8',\n",
       "  '39',\n",
       "  '0.13320908',\n",
       "  '0.5543784',\n",
       "  '',\n",
       "  '-1810.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '1.0',\n",
       "  '0.0'],\n",
       " ['110836',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'N',\n",
       "  '1',\n",
       "  '126000.0',\n",
       "  '454500.0',\n",
       "  '14791.5',\n",
       "  '454500.0',\n",
       "  '8',\n",
       "  '1',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.009334',\n",
       "  '-13351',\n",
       "  '-6261',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '1',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '18',\n",
       "  '3.0',\n",
       "  'TUESDAY',\n",
       "  '13',\n",
       "  '38',\n",
       "  '',\n",
       "  '0.78073716',\n",
       "  '0.5797274',\n",
       "  '-1197.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '1.0'],\n",
       " ['110985',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '0',\n",
       "  '76500.0',\n",
       "  '454500.0',\n",
       "  '14791.5',\n",
       "  '454500.0',\n",
       "  '8',\n",
       "  '4',\n",
       "  '2',\n",
       "  '6',\n",
       "  '0.007114',\n",
       "  '-16847',\n",
       "  '-1194',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '19',\n",
       "  '2.0',\n",
       "  'SUNDAY',\n",
       "  '15',\n",
       "  '50',\n",
       "  '',\n",
       "  '0.19403037',\n",
       "  '',\n",
       "  '-1150.0',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  ''],\n",
       " ['109621',\n",
       "  '0',\n",
       "  '2',\n",
       "  'F',\n",
       "  'N',\n",
       "  'N',\n",
       "  '1',\n",
       "  '67500.0',\n",
       "  '513531.0',\n",
       "  '24835.5',\n",
       "  '459000.0',\n",
       "  '2',\n",
       "  '1',\n",
       "  '3',\n",
       "  '6',\n",
       "  '0.008068',\n",
       "  '-10828',\n",
       "  '-2693',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  '10',\n",
       "  '3.0',\n",
       "  'THURSDAY',\n",
       "  '12',\n",
       "  '28',\n",
       "  '0.42454174',\n",
       "  '0.17806706',\n",
       "  '0.59892625',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '2.0']]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "app_data_rdd1 = app_data_rdd.map(lambda x: x.split(','))\n",
    "header = app_data_rdd1.first()\n",
    "app_data_rdd1 = app_data_rdd1.filter(lambda x: x != header)\n",
    "\n",
    "app_data_rdd1.persist()  \n",
    "\n",
    "app_data_count = app_data_rdd1.count()\n",
    "print('The total count for appilication data is', app_data_count)\n",
    "app_data_rdd1.take(10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The total count for appilication data is 935037\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[['269239',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '8',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-207',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '65'],\n",
       " ['221473',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '8',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-317',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Refreshed',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '7817'],\n",
       " ['107678',\n",
       "  '4',\n",
       "  '',\n",
       "  '24480.0',\n",
       "  '24480.0',\n",
       "  '0.0',\n",
       "  '24480.0',\n",
       "  '12',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Refused',\n",
       "  '-1252',\n",
       "  'Cash through the bank',\n",
       "  'LIMIT',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'Mobile',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '92',\n",
       "  'Connectivity',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'POS mobile with interest',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '172'],\n",
       " ['168941',\n",
       "  '4',\n",
       "  '9580.455',\n",
       "  '41296.5',\n",
       "  '46593.0',\n",
       "  '0.0',\n",
       "  '41296.5',\n",
       "  '8',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Approved',\n",
       "  '-633',\n",
       "  'Cash through the bank',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'New',\n",
       "  'Mobile',\n",
       "  'POS',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '55',\n",
       "  'Connectivity',\n",
       "  '6.0',\n",
       "  'high',\n",
       "  'POS mobile with interest',\n",
       "  '365243.0',\n",
       "  '-602.0',\n",
       "  '-452.0',\n",
       "  '-452.0',\n",
       "  '-444.0',\n",
       "  '0.0',\n",
       "  '285'],\n",
       " ['204082',\n",
       "  '3',\n",
       "  '',\n",
       "  '450000.0',\n",
       "  '450000.0',\n",
       "  '0.0',\n",
       "  '450000.0',\n",
       "  '17',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Refused',\n",
       "  '-368',\n",
       "  'XNA',\n",
       "  'HC',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '60',\n",
       "  'Connectivity',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '391'],\n",
       " ['148658',\n",
       "  '2',\n",
       "  '7875.0',\n",
       "  '0.0',\n",
       "  '157500.0',\n",
       "  '',\n",
       "  '',\n",
       "  '9',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Refused',\n",
       "  '-419',\n",
       "  'XNA',\n",
       "  'HC',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'Cards',\n",
       "  'x-sell',\n",
       "  '\"8\"',\n",
       "  '4',\n",
       "  'XNA',\n",
       "  '0.0',\n",
       "  'XNA',\n",
       "  'Card X-Sell',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '471'],\n",
       " ['190200',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '12',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Refused',\n",
       "  '-405',\n",
       "  'XNA',\n",
       "  'SCOFR',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '691'],\n",
       " ['152739',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '6',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-413',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '967'],\n",
       " ['265668',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '11',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-231',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '127572'],\n",
       " ['162831',\n",
       "  '2',\n",
       "  '4500.0',\n",
       "  '90000.0',\n",
       "  '90000.0',\n",
       "  '',\n",
       "  '90000.0',\n",
       "  '11',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Refused',\n",
       "  '-23',\n",
       "  'XNA',\n",
       "  'HC',\n",
       "  'Family',\n",
       "  'Refreshed',\n",
       "  'XNA',\n",
       "  'Cards',\n",
       "  'x-sell',\n",
       "  '\"4\"',\n",
       "  '150',\n",
       "  'Furniture',\n",
       "  '0.0',\n",
       "  'XNA',\n",
       "  'Card X-Sell',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '1302']]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prev_data_rdd1 = prev_data_rdd.map(lambda x: x.split(','))\n",
    "header = prev_data_rdd1.first()\n",
    "prev_data_rdd1 = prev_data_rdd1.filter(lambda x: x != header)\n",
    "\n",
    "prev_data_rdd1.persist()  \n",
    "\n",
    "prev_data_count = prev_data_rdd1.count()\n",
    "print('The total count for appilication data is', prev_data_count)\n",
    "\n",
    "prev_data_rdd1.take(10)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "The total count for appilication data is 126\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[['4', 'name_type_suite', 'Other_B', '2'],\n",
       " ['5', 'name_type_suite', 'Children', '3'],\n",
       " ['55', 'organization_type', 'Business Entity Type 2', '1'],\n",
       " ['56', 'organization_type', 'Agriculture', '2'],\n",
       " ['57', 'organization_type', 'Industry: type 13', '3'],\n",
       " ['58', 'organization_type', 'Religion', '4'],\n",
       " ['59', 'organization_type', 'Construction', '5'],\n",
       " ['60', 'organization_type', 'Police', '6'],\n",
       " ['30', 'housing_type', 'Rented apartment', '1'],\n",
       " ['31', 'housing_type', 'Co-op apartment', '2']]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from io import StringIO\n",
    "import csv\n",
    "\n",
    "\n",
    "value_dict_rdd1 = value_dict_rdd.map(lambda line: next(csv.reader(StringIO(line))))\n",
    "\n",
    "header = value_dict_rdd1.first()\n",
    "value_dict_rdd1 = value_dict_rdd1.filter(lambda x: x != header)\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "value_dict_rdd1.persist()\n",
    "\n",
    "value_dict_count = value_dict_rdd1.count()\n",
    "print('The total count for appilication data is', value_dict_count)\n",
    "value_dict_rdd1.take(10)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1.1.4 Drop the following columns from RDDs:  \n",
    "previous_application: sellerplace_area, name_seller_industry  \n",
    "application_data: All columns start with flag_ and amt_credit_req_(except for amt_credit_req_last_year)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "22\n",
      "23\n"
     ]
    }
   ],
   "source": [
    "header = prev_data_rdd.first()\n",
    "header = header.split(\",\")\n",
    "for i in range (len(header)):\n",
    "    header[i] = header[i][1:-1]\n",
    "index1 = header.index('sellerplace_area')\n",
    "index2 = header.index('name_seller_industry')\n",
    "print(index1)\n",
    "print(index2)\n",
    "\n",
    "prev_data_rdd1 = prev_data_rdd1.map(lambda row: row[:22] + row[23+1:])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "39\n",
      "Columns matching the pattern: [19, 20, 21, 22, 23, 24, 34, 35, 36, 37, 38, 39]\n"
     ]
    }
   ],
   "source": [
    "import re\n",
    "\n",
    "header = app_data_rdd.first()\n",
    "header = header.split(\",\")\n",
    "for i in range(len(header)):\n",
    "    header[i] = header[i][1:-1]\n",
    "\n",
    "pattern = re.compile(r\".*(flag_|amt_credit_req_).*\")\n",
    "index1 = header.index('amt_credit_req_last_year')\n",
    "\n",
    "print(index1)\n",
    "\n",
    "matching_columns = [i for i, col_name in enumerate(header) if pattern.search(col_name)]\n",
    "\n",
    "if matching_columns:\n",
    "    print(\"Columns matching the pattern:\", matching_columns)\n",
    "else:\n",
    "    print(\"No columns match the pattern.\")\n",
    "\n",
    "\n",
    "app_data_rdd1 = app_data_rdd1.map(lambda row: row[:19] + row[25:34] + row[39:])\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1.2 Data Partitioning in RDD <a class=\"anchor\" name=\"1.2\"></a>\n",
    "1.2.1 For each RDD, print out the total number of partitions and the number of records in each partition. Answer the following questions:   \n",
    "How many partitions do the above RDDs have?   \n",
    "How is the data in these RDDs partitioned by default, when we do not explicitly specify any partitioning strategy?   \n",
    "Can you explain why it will be partitioned in this number? If I only have one single-core CPU on my PC, what is the default partition's number? (Hint: search the Spark source code to try to answer this question.)   \n",
    "Write the code and your explanation in Markdown cells."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "App data partitions: 2\n",
      "Partition 0: 86272 records\n",
      "Partition 1: 86319 records\n"
     ]
    }
   ],
   "source": [
    "print('App data partitions:', app_data_rdd1.getNumPartitions())\n",
    "\n",
    "partition_counts = app_data_rdd1.mapPartitionsWithIndex(lambda index, iterator: [(index, len(list(iterator)))])\n",
    "result = partition_counts.collect()\n",
    "\n",
    "for partition_index, record_count in result:\n",
    "    print(f\"Partition {partition_index}: {record_count} records\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Previous App data partitions:  6\n",
      "Partition 0: 167804 records\n",
      "Partition 1: 163835 records\n",
      "Partition 2: 162603 records\n",
      "Partition 3: 162683 records\n",
      "Partition 4: 162437 records\n",
      "Partition 5: 115675 records\n"
     ]
    }
   ],
   "source": [
    "print('Previous App data partitions: ',prev_data_rdd1.getNumPartitions())\n",
    "\n",
    "partition_counts = prev_data_rdd1.mapPartitionsWithIndex(lambda index, iterator: [(index, len(list(iterator)))])\n",
    "result = partition_counts.collect()\n",
    "\n",
    "for partition_index, record_count in result:\n",
    "    print(f\"Partition {partition_index}: {record_count} records\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Value Dict partitions:  2\n",
      "Partition 0: 66 records\n",
      "Partition 1: 60 records\n"
     ]
    }
   ],
   "source": [
    "print('Value Dict partitions: ',value_dict_rdd1.getNumPartitions())\n",
    "\n",
    "partition_counts = value_dict_rdd1.mapPartitionsWithIndex(lambda index, iterator: [(index, len(list(iterator)))])\n",
    "result = partition_counts.collect()\n",
    "\n",
    "for partition_index, record_count in result:\n",
    "    print(f\"Partition {partition_index}: {record_count} records\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### ANSWER\n",
    "Partitions are partitioned by random equal partitioning order if method is not stated, if your cpu only have 1 core then there can only be one cpu processing it thus only able to parition one. Since previous app data has many record spark partitions it with more of 6 compared to 2 as spark wants ensure that each partition is manageable.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1.2.2. The metadata shows that days in the dataset are stored as a relative number. For example, if the application date is 2/Jan/2024, -1 means 1/Jan/2024, -2 means 31/Dec/2023.  \n",
    "Create a UDF function that takes two parameters: a date and an integer value, and returns a date.   (note: the integer can be either positive or negative). (3%)  \n",
    "Assuming all applications are made on 1/Jan/2024, create a new column named decision_date, use the UDF function to fill its values from days_decisions (3%)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "08/Jun/2023\n",
      "31/Dec/2023\n"
     ]
    }
   ],
   "source": [
    "from datetime import datetime, timedelta\n",
    "from pyspark.sql.functions import col, udf\n",
    "from pyspark.sql.types import StringType\n",
    "\n",
    "from datetime import datetime, timedelta\n",
    "\n",
    "def set_application_date(date, value):\n",
    "    date_format = \"%d/%b/%Y\"\n",
    "    try:\n",
    "        if isinstance(date, str):\n",
    "            parsed_date = datetime.strptime(date, date_format)\n",
    "            if value == 0:\n",
    "                return date\n",
    "            elif value != 0:\n",
    "                updated_date = parsed_date + timedelta(days=int(value))\n",
    "                return updated_date.strftime(date_format)\n",
    "    except Exception as e:\n",
    "        print(f\"Error: {e}\")\n",
    "        return \"Invalid Date/Value\"  # Return a placeholder or handle the error as needed\n",
    "\n",
    "\n",
    "\n",
    "print(set_application_date(\"1/Jan/2024\", -207))\n",
    "print(set_application_date(\"2/Jan/2024\", -2))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[['269239',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '8',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-207',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '65',\n",
       "  '08/Jun/2023'],\n",
       " ['221473',\n",
       "  '3',\n",
       "  '',\n",
       "  '0.0',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  '8',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Canceled',\n",
       "  '-317',\n",
       "  'XNA',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'Refreshed',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"6\"',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '7817',\n",
       "  '18/Feb/2023'],\n",
       " ['107678',\n",
       "  '4',\n",
       "  '',\n",
       "  '24480.0',\n",
       "  '24480.0',\n",
       "  '0.0',\n",
       "  '24480.0',\n",
       "  '12',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Refused',\n",
       "  '-1252',\n",
       "  'Cash through the bank',\n",
       "  'LIMIT',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'Mobile',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'POS mobile with interest',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '172',\n",
       "  '28/Jul/2020'],\n",
       " ['168941',\n",
       "  '4',\n",
       "  '9580.455',\n",
       "  '41296.5',\n",
       "  '46593.0',\n",
       "  '0.0',\n",
       "  '41296.5',\n",
       "  '8',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XAP',\n",
       "  'Approved',\n",
       "  '-633',\n",
       "  'Cash through the bank',\n",
       "  'XAP',\n",
       "  '\"\"',\n",
       "  'New',\n",
       "  'Mobile',\n",
       "  'POS',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '6.0',\n",
       "  'high',\n",
       "  'POS mobile with interest',\n",
       "  '365243.0',\n",
       "  '-602.0',\n",
       "  '-452.0',\n",
       "  '-452.0',\n",
       "  '-444.0',\n",
       "  '0.0',\n",
       "  '285',\n",
       "  '08/Apr/2022'],\n",
       " ['204082',\n",
       "  '3',\n",
       "  '',\n",
       "  '450000.0',\n",
       "  '450000.0',\n",
       "  '0.0',\n",
       "  '450000.0',\n",
       "  '17',\n",
       "  '0.0',\n",
       "  '',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Refused',\n",
       "  '-368',\n",
       "  'XNA',\n",
       "  'HC',\n",
       "  '\"\"',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  'XNA',\n",
       "  '\"3\"',\n",
       "  '',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '391',\n",
       "  '29/Dec/2022']]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prev_data_rdd2 = prev_data_rdd1.map(lambda x: x + ['1/Jan/2024'])\n",
    "updated_rdd = prev_data_rdd2.map(lambda x: x[:-1] + [set_application_date(x[-1], x[13])])\n",
    "updated_rdd.take(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "1.2.3. Join application_data and previous_application with value_dict and replace integer values with string values from the dictionary. (5%)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('name_type_suite',\n",
       "  [('Other_B', '2'),\n",
       "   ('Children', '3'),\n",
       "   ('Group of people', '4'),\n",
       "   ('Unaccompanied', '5'),\n",
       "   ('Family', '6'),\n",
       "   ('Other_A', '7'),\n",
       "   ('Spouse, partner', '8'),\n",
       "   ('(Empty)', '1')]),\n",
       " ('housing_type',\n",
       "  [('Rented apartment', '1'),\n",
       "   ('Co-op apartment', '2'),\n",
       "   ('Office apartment', '3'),\n",
       "   ('Municipal apartment', '4'),\n",
       "   ('With parents', '5'),\n",
       "   ('House / apartment', '6')]),\n",
       " ('housetype_mode',\n",
       "  [('specific housing', '1'),\n",
       "   ('terraced house', '2'),\n",
       "   ('block of flats', '3'),\n",
       "   ('(Empty)', '4')]),\n",
       " ('education_type',\n",
       "  [('Secondary / secondary special', '1'),\n",
       "   ('Incomplete higher', '2'),\n",
       "   ('Lower secondary', '3'),\n",
       "   ('Higher education', '4'),\n",
       "   ('Academic degree', '5')]),\n",
       " ('occupation_type',\n",
       "  [('Private service staff', '1'),\n",
       "   ('Realty agents', '2'),\n",
       "   ('Waiters/barmen staff', '3'),\n",
       "   ('IT staff', '4'),\n",
       "   ('Managers', '5'),\n",
       "   ('Cleaning staff', '6'),\n",
       "   ('Cooking staff', '7'),\n",
       "   ('Security staff', '8'),\n",
       "   ('Drivers', '9'),\n",
       "   ('Accountants', '10'),\n",
       "   ('Medicine staff', '11'),\n",
       "   ('Laborers', '12'),\n",
       "   ('Secretaries', '13'),\n",
       "   ('HR staff', '14'),\n",
       "   ('High skill tech staff', '15'),\n",
       "   ('Sales staff', '16'),\n",
       "   ('Low-skill Laborers', '17'),\n",
       "   ('Core staff', '19'),\n",
       "   ('(Empty)', '18')]),\n",
       " ('income_type',\n",
       "  [('State servant', '1'),\n",
       "   ('Working', '2'),\n",
       "   ('Student', '3'),\n",
       "   ('Maternity leave', '4'),\n",
       "   ('Pensioner', '5'),\n",
       "   ('Businessman', '6'),\n",
       "   ('Unemployed', '7'),\n",
       "   ('Commercial associate', '8')]),\n",
       " ('family_status',\n",
       "  [('Unknown', '1'),\n",
       "   ('Civil marriage', '2'),\n",
       "   ('Married', '3'),\n",
       "   ('Separated', '4'),\n",
       "   ('Widow', '5'),\n",
       "   ('Single / not married', '6')]),\n",
       " ('channel_type',\n",
       "  [('Contact center', '1'),\n",
       "   ('Car dealer', '2'),\n",
       "   ('Country-wide', '3'),\n",
       "   ('Stone', '4'),\n",
       "   ('Regional / Local', '5'),\n",
       "   ('Credit and cash offices', '6'),\n",
       "   ('Channel of corporate sales', '7'),\n",
       "   ('AP+ (Cash loan)', '8')]),\n",
       " ('organization_type',\n",
       "  [('Business Entity Type 2', '1'),\n",
       "   ('Agriculture', '2'),\n",
       "   ('Industry: type 13', '3'),\n",
       "   ('Religion', '4'),\n",
       "   ('Construction', '5'),\n",
       "   ('Police', '6'),\n",
       "   ('Culture', '7'),\n",
       "   ('Transport: type 1', '8'),\n",
       "   ('Other', '9'),\n",
       "   ('Realtor', '10'),\n",
       "   ('Business Entity Type 1', '11'),\n",
       "   ('Industry: type 8', '12'),\n",
       "   ('Insurance', '13'),\n",
       "   ('Industry: type 2', '14'),\n",
       "   ('Transport: type 2', '15'),\n",
       "   ('Security Ministries', '16'),\n",
       "   ('Industry: type 1', '17'),\n",
       "   ('Postal', '18'),\n",
       "   ('Industry: type 10', '19'),\n",
       "   ('University', '20'),\n",
       "   ('Trade: type 3', '21'),\n",
       "   ('Medicine', '22'),\n",
       "   ('Cleaning', '23'),\n",
       "   ('Industry: type 4', '24'),\n",
       "   ('Transport: type 3', '25'),\n",
       "   ('Mobile', '26'),\n",
       "   ('Security', '27'),\n",
       "   ('Government', '28'),\n",
       "   ('Industry: type 7', '29'),\n",
       "   ('School', '30'),\n",
       "   ('XNA', '31'),\n",
       "   ('Industry: type 11', '32'),\n",
       "   ('Telecom', '33'),\n",
       "   ('Trade: type 1', '34'),\n",
       "   ('Industry: type 3', '35'),\n",
       "   ('Business Entity Type 3', '36'),\n",
       "   ('Trade: type 4', '37'),\n",
       "   ('Transport: type 4', '38'),\n",
       "   ('Bank', '39'),\n",
       "   ('Advertising', '40'),\n",
       "   ('Trade: type 6', '41'),\n",
       "   ('Trade: type 7', '42'),\n",
       "   ('Restaurant', '43'),\n",
       "   ('Trade: type 2', '44'),\n",
       "   ('Industry: type 5', '45'),\n",
       "   ('Industry: type 6', '46'),\n",
       "   ('Legal Services', '47'),\n",
       "   ('Trade: type 5', '48'),\n",
       "   ('Services', '49'),\n",
       "   ('Self-employed', '50'),\n",
       "   ('Hotel', '51'),\n",
       "   ('Electricity', '52'),\n",
       "   ('Industry: type 9', '53'),\n",
       "   ('Kindergarten', '54'),\n",
       "   ('Emergency', '55'),\n",
       "   ('Housing', '56'),\n",
       "   ('Industry: type 12', '57'),\n",
       "   ('Military', '58')]),\n",
       " ('contract_type',\n",
       "  [('XNA', '1'),\n",
       "   ('Revolving loans', '2'),\n",
       "   ('Cash loans', '3'),\n",
       "   ('Consumer loans', '4')])]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "value_dict_rdd1Key = value_dict_rdd1.map(lambda x: (x[1], (x[2], x[3])))\n",
    "grouped_rdd = value_dict_rdd1Key.groupByKey()\n",
    "\n",
    "# For each key, create a list of values\n",
    "column_values_rdd = grouped_rdd.mapValues(list)\n",
    "\n",
    "column_values_rdd.take(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "app_data_rdd1 = app_data_rdd.map(lambda line: next(csv.reader(StringIO(line))))\n",
    "prev_data_rdd1 = prev_data_rdd.map(lambda line: next(csv.reader(StringIO(line))))\n",
    "\n",
    "# Transform app_data_rdd1 to key-value pairs\n",
    "app_data_kv = app_data_rdd1.map(lambda x: (x[0], x))\n",
    "\n",
    "# Transform prev_data_rdd1 to key-value pairs\n",
    "prev_data_kv = prev_data_rdd1.map(lambda x: (x[0], x))\n",
    "\n",
    "joined_rdd = app_data_kv.join(prev_data_kv)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "indexed_rdd = joined_rdd.zipWithIndex()\n",
    "\n",
    "element_at_0 = indexed_rdd.filter(lambda x: x[1] == 0).map(lambda x: x[0]).first()\n",
    "element_at_294368 = indexed_rdd.filter(lambda x: x[1] == 294368).map(lambda x: x[0]).first()\n",
    "\n",
    "filtered_rdd = indexed_rdd.filter(lambda x: x[1] != 0 and x[1] != 294368).map(lambda x: x[0])\n",
    "\n",
    "swapped_rdd = spark.sparkContext.parallelize([element_at_294368, element_at_0]) \\\n",
    "    .union(filtered_rdd)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "values_only_rdd = swapped_rdd.map(lambda x: x[1])\n",
    "flattened_rdd = values_only_rdd.map(lambda x: x[0] + x[1])\n",
    "\n",
    "header = flattened_rdd.first()\n",
    "flattened_rdd1 = flattened_rdd.filter(lambda x: x != header)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "mapping_dict = column_values_rdd.flatMap(lambda x: [((x[0], value[1]), value[0]) for value in x[1]]).collectAsMap()\n",
    "\n",
    "column_names = ['id_app', 'target', 'contract_type', 'gender', 'own_car', 'own_property', 'num_of_children', 'income_total', 'amt_credit', 'amt_annuity', 'amt_goods_price', 'income_type', 'education_type', 'family_status', 'housing_type', 'region_population', 'days_birth', 'days_employed', 'own_car_age', 'flag_mobile', 'flag_emp_phone', 'flag_work_phone', 'flag_cont_mobile', 'flag_phone', 'flag_email', 'occupation_type', 'cnt_fam_members', 'weekday_app_process_start', 'hour_app_process_start', 'organization_type', 'credit_score_1', 'credit_score_2', 'credit_score_3', 'days_last_phone_change', 'amt_credit_req_last_hour', 'amt_credit_req_last_day', 'amt_credit_req_last_week', 'amt_credit_req_last_month', 'amt_credit_req_last_quarter', 'amt_credit_req_last_year', 'id_app', 'contract_type', 'amt_annuity', 'amt_application', 'amt_credit', 'amt_down_payment', 'amt_goods_price', 'hour_appr_process_start', 'rate_down_payment', 'rate_interest_primary', 'rate_interest_privileged', 'name_cash_loan_purpose', 'name_contract_status', 'days_decision', 'name_payment_type', 'code_rejection_reason', 'name_type_suite', 'name_client_type', 'name_goods_category', 'name_portfolio', 'name_product_type', 'channel_type', 'sellerplace_area', 'name_seller_industry', 'cnt_payment', 'name_yield_group', 'product_combination', 'days_first_drawing', 'days_first_due', 'days_last_due_1st_version', 'days_last_due', 'days_termination', 'nflag_insured_on_approval', 'id']\n",
    "transformed_rdd = flattened_rdd1.map(lambda row: [mapping_dict.get((column_names[i], row[i]), row[i]) for i in range(len(row))])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[['110985',\n",
       "  '0',\n",
       "  'Revolving loans',\n",
       "  'F',\n",
       "  'N',\n",
       "  'Y',\n",
       "  '0',\n",
       "  '76500.0',\n",
       "  '454500.0',\n",
       "  '14791.5',\n",
       "  '454500.0',\n",
       "  'Commercial associate',\n",
       "  'Higher education',\n",
       "  'Civil marriage',\n",
       "  'House / apartment',\n",
       "  '0.007114',\n",
       "  '-16847',\n",
       "  '-1194',\n",
       "  '',\n",
       "  '1',\n",
       "  '1',\n",
       "  '0',\n",
       "  '1',\n",
       "  '0',\n",
       "  '0',\n",
       "  'Core staff',\n",
       "  '2.0',\n",
       "  'SUNDAY',\n",
       "  '15',\n",
       "  'Self-employed',\n",
       "  '',\n",
       "  '0.19403037',\n",
       "  '',\n",
       "  '-1150.0',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '110985',\n",
       "  'Cash loans',\n",
       "  '15219.0',\n",
       "  '225000.0',\n",
       "  '225000.0',\n",
       "  '',\n",
       "  '225000.0',\n",
       "  '11',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  'Other',\n",
       "  'Refused',\n",
       "  '-1453',\n",
       "  'Cash through the bank',\n",
       "  'LIMIT',\n",
       "  'Unaccompanied',\n",
       "  'Repeater',\n",
       "  'XNA',\n",
       "  'Cash',\n",
       "  'walk-in',\n",
       "  'Credit and cash offices',\n",
       "  '-1',\n",
       "  'XNA',\n",
       "  '36.0',\n",
       "  'high',\n",
       "  'Cash Street: high',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '',\n",
       "  '142625']]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "transformed_rdd.take(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1.3 Query/Analysis <a class=\"anchor\" name=\"1.3\"></a>\n",
    "For this part, write relevant RDD operations to answer the following queries.\n",
    "\n",
    "**1.3.1 Calculate the total approved loan amount for each year, each month. Print the results in the format of year, month, total_amount. (5%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "approved_loan_rdd = updated_rdd.map(lambda row: (row[12], row[4], row[-1] if len(row) > 0 else None))\n",
    "approved_loan_rdd1 = approved_loan_rdd.filter(lambda row: row[0] == 'Approved')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[('Approved', '46593.0', '08/Apr/2022'),\n",
       " ('Approved', '112500.0', '23/Jun/2023'),\n",
       " ('Approved', '790830.0', '23/Jan/2023')]"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "approved_loan_rdd1.take(3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Year: 2016, Month: Jan, Total Amount: 172331955.0\n",
      "Year: 2016, Month: Feb, Total Amount: 176301522.0\n",
      "Year: 2016, Month: Mar, Total Amount: 190586187.0\n",
      "Year: 2016, Month: Apr, Total Amount: 196686805.5\n",
      "Year: 2016, Month: May, Total Amount: 195882363.0\n",
      "Year: 2016, Month: Jun, Total Amount: 200585488.5\n",
      "Year: 2016, Month: Jul, Total Amount: 228541482.0\n",
      "Year: 2016, Month: Aug, Total Amount: 241038688.5\n",
      "Year: 2016, Month: Sep, Total Amount: 252035883.0\n",
      "Year: 2016, Month: Oct, Total Amount: 271204798.5\n",
      "Year: 2016, Month: Nov, Total Amount: 270581526.0\n",
      "Year: 2016, Month: Dec, Total Amount: 297452236.5\n",
      "Year: 2017, Month: Jan, Total Amount: 314613220.5\n",
      "Year: 2017, Month: Feb, Total Amount: 279918481.5\n",
      "Year: 2017, Month: Mar, Total Amount: 326222946.0\n",
      "Year: 2017, Month: Apr, Total Amount: 336857661.0\n",
      "Year: 2017, Month: May, Total Amount: 315156078.0\n",
      "Year: 2017, Month: Jun, Total Amount: 272737849.5\n",
      "Year: 2017, Month: Jul, Total Amount: 302933970.0\n",
      "Year: 2017, Month: Aug, Total Amount: 298022152.5\n",
      "Year: 2017, Month: Sep, Total Amount: 299728480.5\n",
      "Year: 2017, Month: Oct, Total Amount: 300883900.5\n",
      "Year: 2017, Month: Nov, Total Amount: 290715579.0\n",
      "Year: 2017, Month: Dec, Total Amount: 273326589.0\n",
      "Year: 2018, Month: Jan, Total Amount: 264444129.0\n",
      "Year: 2018, Month: Feb, Total Amount: 232951590.0\n",
      "Year: 2018, Month: Mar, Total Amount: 229787244.0\n",
      "Year: 2018, Month: Apr, Total Amount: 218495137.5\n",
      "Year: 2018, Month: May, Total Amount: 221873809.5\n",
      "Year: 2018, Month: Jun, Total Amount: 219596395.5\n",
      "Year: 2018, Month: Jul, Total Amount: 231478654.5\n",
      "Year: 2018, Month: Aug, Total Amount: 233366589.0\n",
      "Year: 2018, Month: Sep, Total Amount: 235388583.0\n",
      "Year: 2018, Month: Oct, Total Amount: 243185103.0\n",
      "Year: 2018, Month: Nov, Total Amount: 246664471.5\n",
      "Year: 2018, Month: Dec, Total Amount: 268972204.5\n",
      "Year: 2019, Month: Jan, Total Amount: 312502351.5\n",
      "Year: 2019, Month: Feb, Total Amount: 289844473.5\n",
      "Year: 2019, Month: Mar, Total Amount: 346178065.5\n",
      "Year: 2019, Month: Apr, Total Amount: 362230330.5\n",
      "Year: 2019, Month: May, Total Amount: 368580523.5\n",
      "Year: 2019, Month: Jun, Total Amount: 353045331.0\n",
      "Year: 2019, Month: Jul, Total Amount: 421113402.0\n",
      "Year: 2019, Month: Aug, Total Amount: 480168891.0\n",
      "Year: 2019, Month: Sep, Total Amount: 487566238.5\n",
      "Year: 2019, Month: Oct, Total Amount: 569283871.5\n",
      "Year: 2019, Month: Nov, Total Amount: 574195972.5\n",
      "Year: 2019, Month: Dec, Total Amount: 630278480.53\n",
      "Year: 2020, Month: Jan, Total Amount: 661536540.52\n",
      "Year: 2020, Month: Feb, Total Amount: 639844456.11\n",
      "Year: 2020, Month: Mar, Total Amount: 696430869.12\n",
      "Year: 2020, Month: Apr, Total Amount: 697139741.9799999\n",
      "Year: 2020, Month: May, Total Amount: 740129531.22\n",
      "Year: 2020, Month: Jun, Total Amount: 758230286.89\n",
      "Year: 2020, Month: Jul, Total Amount: 852021502.32\n",
      "Year: 2020, Month: Aug, Total Amount: 925993174.9500002\n",
      "Year: 2020, Month: Sep, Total Amount: 945548278.8700001\n",
      "Year: 2020, Month: Oct, Total Amount: 1054130882.54\n",
      "Year: 2020, Month: Nov, Total Amount: 1222475720.12\n",
      "Year: 2020, Month: Dec, Total Amount: 1453848381.54\n",
      "Year: 2021, Month: Jan, Total Amount: 1638594905.3200002\n",
      "Year: 2021, Month: Feb, Total Amount: 1506077740.13\n",
      "Year: 2021, Month: Mar, Total Amount: 1785125823.04\n",
      "Year: 2021, Month: Apr, Total Amount: 1905605053.56\n",
      "Year: 2021, Month: May, Total Amount: 2109288236.1999998\n",
      "Year: 2021, Month: Jun, Total Amount: 2159683930.57\n",
      "Year: 2021, Month: Jul, Total Amount: 2456136761.42\n",
      "Year: 2021, Month: Aug, Total Amount: 2620455701.2539997\n",
      "Year: 2021, Month: Sep, Total Amount: 2743595918.63\n",
      "Year: 2021, Month: Oct, Total Amount: 2809307024.53\n",
      "Year: 2021, Month: Nov, Total Amount: 3110750973.18\n",
      "Year: 2021, Month: Dec, Total Amount: 3442364323.8599997\n",
      "Year: 2022, Month: Jan, Total Amount: 3736882127.2349997\n",
      "Year: 2022, Month: Feb, Total Amount: 3141359382.5000005\n",
      "Year: 2022, Month: Mar, Total Amount: 3360006106.6280003\n",
      "Year: 2022, Month: Apr, Total Amount: 3235593134.1879997\n",
      "Year: 2022, Month: May, Total Amount: 3384010629.3089995\n",
      "Year: 2022, Month: Jun, Total Amount: 3204646891.9190006\n",
      "Year: 2022, Month: Jul, Total Amount: 3421806601.97\n",
      "Year: 2022, Month: Aug, Total Amount: 3494581257.8980002\n",
      "Year: 2022, Month: Sep, Total Amount: 3219852918.1029997\n",
      "Year: 2022, Month: Oct, Total Amount: 3103696486.016\n",
      "Year: 2022, Month: Nov, Total Amount: 2943577039.117\n",
      "Year: 2022, Month: Dec, Total Amount: 3204203654.9600005\n",
      "Year: 2023, Month: Jan, Total Amount: 3271347924.788\n",
      "Year: 2023, Month: Feb, Total Amount: 2752321157.494\n",
      "Year: 2023, Month: Mar, Total Amount: 3032140853.3409996\n",
      "Year: 2023, Month: Apr, Total Amount: 2896655922.8089995\n",
      "Year: 2023, Month: May, Total Amount: 2732017860.211\n",
      "Year: 2023, Month: Jun, Total Amount: 2523485234.977\n",
      "Year: 2023, Month: Jul, Total Amount: 2112219144.3280003\n",
      "Year: 2023, Month: Aug, Total Amount: 1610579708.6430001\n",
      "Year: 2023, Month: Sep, Total Amount: 1258096566.537\n",
      "Year: 2023, Month: Oct, Total Amount: 913411315.686\n",
      "Year: 2023, Month: Nov, Total Amount: 763031928.926\n",
      "Year: 2023, Month: Dec, Total Amount: 1126614326.829\n"
     ]
    }
   ],
   "source": [
    "import calendar\n",
    "\n",
    "year_month_amount_rdd = approved_loan_rdd1.map(\n",
    "    lambda row: (\n",
    "        (datetime.strptime(row[2], '%d/%b/%Y').year, datetime.strptime(row[2], '%d/%b/%Y').month),\n",
    "        float(row[1])\n",
    "    )\n",
    ")\n",
    "\n",
    "total_amount_by_year_month = year_month_amount_rdd.reduceByKey(lambda a, b: a + b)\n",
    "\n",
    "sorted_total_amount = total_amount_by_year_month.sortBy(lambda x: (x[0][0], x[0][1]))\n",
    "\n",
    "final_results = sorted_total_amount.map(lambda x: (x[0][0], calendar.month_abbr[x[0][1]], x[1])).collect()\n",
    "\n",
    "for year, month_name, total_amount in final_results:\n",
    "    print(f\"Year: {year}, Month: {month_name}, Total Amount: {total_amount}\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**1.3.2 For each hour when the applications start (0-23), compute and print the percentage ratio of application cancellation. (5%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "cancelled_loan_rdd = updated_rdd.map(lambda row: (row[12], row[7] if len(row) > 0 else None))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "cancelled_loan_rdd1 = cancelled_loan_rdd.filter(lambda row: row[0] == 'Canceled')\n",
    "pair_rdd = cancelled_loan_rdd1.map(lambda row: (row[1], 1))\n",
    "\n",
    "reduced_rdd = pair_rdd.reduceByKey(lambda a, b: a + b)\n",
    "\n",
    "reduced_rdd_cancel = reduced_rdd.map(lambda x: (int(x[0]), x[1])).sortByKey()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "cancelled_loan_rdd = updated_rdd.map(lambda row: (row[12], row[7] if len(row) > 0 else None))\n",
    "pair_rdd = cancelled_loan_rdd.map(lambda row: (row[1], 1))\n",
    "\n",
    "reduced_rdd = pair_rdd.reduceByKey(lambda a, b: a + b)\n",
    "reduced_rdd_total = reduced_rdd.map(lambda x: (int(x[0]), x[1])).sortByKey()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Hour: 0, Cancellation Percentage: 11.86%\n",
      "Hour: 1, Cancellation Percentage: 31.20%\n",
      "Hour: 2, Cancellation Percentage: 37.85%\n",
      "Hour: 3, Cancellation Percentage: 31.75%\n",
      "Hour: 4, Cancellation Percentage: 26.31%\n",
      "Hour: 5, Cancellation Percentage: 24.28%\n",
      "Hour: 6, Cancellation Percentage: 22.48%\n",
      "Hour: 7, Cancellation Percentage: 22.44%\n",
      "Hour: 8, Cancellation Percentage: 20.61%\n",
      "Hour: 9, Cancellation Percentage: 22.20%\n",
      "Hour: 10, Cancellation Percentage: 21.44%\n",
      "Hour: 11, Cancellation Percentage: 19.65%\n",
      "Hour: 12, Cancellation Percentage: 18.78%\n",
      "Hour: 13, Cancellation Percentage: 18.17%\n",
      "Hour: 14, Cancellation Percentage: 18.08%\n",
      "Hour: 15, Cancellation Percentage: 17.79%\n",
      "Hour: 16, Cancellation Percentage: 17.52%\n",
      "Hour: 17, Cancellation Percentage: 16.71%\n",
      "Hour: 18, Cancellation Percentage: 14.32%\n",
      "Hour: 19, Cancellation Percentage: 10.29%\n",
      "Hour: 20, Cancellation Percentage: 7.29%\n",
      "Hour: 21, Cancellation Percentage: 10.34%\n",
      "Hour: 22, Cancellation Percentage: 18.16%\n",
      "Hour: 23, Cancellation Percentage: 11.71%\n"
     ]
    }
   ],
   "source": [
    "joined_rdd = reduced_rdd_cancel.join(reduced_rdd_total)\n",
    "\n",
    "# Sort the joined RDD by the hour key\n",
    "sorted_joined_rdd = joined_rdd.sortByKey()\n",
    "\n",
    "# Calculate the percentage of cancellations\n",
    "percentage_rdd = sorted_joined_rdd.mapValues(lambda x: (x[0] / x[1] * 100) if x[1] != 0 else 0)\n",
    "\n",
    "# Collect and print the results\n",
    "percentage_results = percentage_rdd.collect()\n",
    "\n",
    "for hour, percentage in percentage_results:\n",
    "    print(f\"Hour: {hour}, Cancellation Percentage: {percentage:.2f}%\")\n",
    "\n",
    "    \n",
    "    \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Part 2. Working with DataFrames <a class=\"anchor\" name=\"2-dataframes\"></a>\n",
    "In this section, you will need to load the given datasets into PySpark DataFrames and use DataFrame functions to answer the queries.\n",
    "### 2.1 Data Preparation and Loading\n",
    "\n",
    "**2.1.1. Load CSVs into separate dataframes. When you create your dataframes, please refer to the metadata file and use appropriate data type for each column.**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql.types import StructType, StructField, IntegerType, StringType, FloatType,BooleanType, DateType\n",
    "\n",
    "application_schema = StructType([\n",
    "    StructField(\"id_app\", IntegerType(), True),\n",
    "    StructField(\"target\", IntegerType(), True),  \n",
    "    StructField(\"contract_type\", StringType(), True),\n",
    "    StructField(\"gender\", StringType(), True),\n",
    "    StructField(\"own_car\", StringType(), True),\n",
    "    StructField(\"own_property\", StringType(), True),\n",
    "    StructField(\"num_of_children\", IntegerType(), True),\n",
    "    StructField(\"income_total\", FloatType(), True),\n",
    "    StructField(\"amt_credit\", FloatType(), True),\n",
    "    StructField(\"amt_annuity\", FloatType(), True),\n",
    "    StructField(\"amt_goods_price\", FloatType(), True),\n",
    "    StructField(\"income_type\", StringType(), True),\n",
    "    StructField(\"education_type\", StringType(), True),\n",
    "    StructField(\"family_status\", StringType(), True),\n",
    "    StructField(\"housing_type\", StringType(), True),\n",
    "    StructField(\"region_population_relative\", FloatType(), True),\n",
    "    StructField(\"days_birth\", IntegerType(), True),\n",
    "    StructField(\"days_employed\", IntegerType(), True),\n",
    "    StructField(\"own_car_age\", IntegerType(), True),\n",
    "    StructField(\"flag_mobile\", BooleanType(), True),\n",
    "    StructField(\"flag_emp_phone\", BooleanType(), True),\n",
    "    StructField(\"flag_work_phone\", BooleanType(), True),\n",
    "    StructField(\"flag_cont_mobile\", BooleanType(), True),\n",
    "    StructField(\"flag_phone\", BooleanType(), True),\n",
    "    StructField(\"flag_email\", BooleanType(), True),\n",
    "    StructField(\"occupation_type\", StringType(), True),\n",
    "    StructField(\"cnt_fam_members\", IntegerType(), True),\n",
    "    StructField(\"weekday_appr_process_start\", StringType(), True),\n",
    "    StructField(\"hour_appr_process_start\", IntegerType(), True),\n",
    "    StructField(\"organization_type\", StringType(), True),\n",
    "    StructField(\"credit_score_1\", FloatType(), True),\n",
    "    StructField(\"credit_score_2\", FloatType(), True),\n",
    "    StructField(\"credit_score_3\", FloatType(), True),\n",
    "    StructField(\"days_last_phone_change\", FloatType(), True),\n",
    "    StructField(\"amt_credit_req_last_hour\", IntegerType(), True),\n",
    "    StructField(\"amt_credit_req_last_day\", IntegerType(), True),\n",
    "    StructField(\"amt_credit_req_last_week\", IntegerType(), True),\n",
    "    StructField(\"amt_credit_req_last_month\", IntegerType(), True),\n",
    "    StructField(\"amt_credit_req_last_quater\", IntegerType(), True),\n",
    "    StructField(\"amt_credit_req_last_year\", StringType(), True)\n",
    "\n",
    "\n",
    "])\n",
    "\n",
    "\n",
    "previous_application_schema = StructType([\n",
    "    StructField(\"id_app\", IntegerType(), True),\n",
    "    StructField(\"contract_type\", StringType(), True),\n",
    "    StructField(\"amt_annuity\", FloatType(), True),\n",
    "    StructField(\"amt_application\", FloatType(), True),\n",
    "    StructField(\"amt_credit\", FloatType(), True),\n",
    "    StructField(\"amt_down_payment\", FloatType(), True),\n",
    "    StructField(\"amt_goods_price\", FloatType(), True),\n",
    "    StructField(\"hour_appr_process_start\", IntegerType(), True),\n",
    "    StructField(\"rate_down_payment\", FloatType(), True),\n",
    "    StructField(\"rate_interest_primary\", FloatType(), True),\n",
    "    StructField(\"rate_interest_privileged\", FloatType(), True),\n",
    "    StructField(\"name_cash_loan_purpose\", StringType(), True),\n",
    "    StructField(\"name_contract_status\", StringType(), True),\n",
    "    StructField(\"days_decision\", IntegerType(), True),\n",
    "    StructField(\"name_payment_type\", StringType(), True),\n",
    "    StructField(\"code_reject_reason\", StringType(), True),\n",
    "    StructField(\"name_type_suite\", StringType(), True),\n",
    "    StructField(\"name_client_type\", StringType(), True),\n",
    "    StructField(\"name_goods_category\", StringType(), True),\n",
    "    StructField(\"name_portfolio\", StringType(), True),\n",
    "    StructField(\"name_product_type\", StringType(), True),\n",
    "    StructField(\"channel_type\", StringType(), True),\n",
    "    StructField(\"sellerplace_area\", IntegerType(), True),\n",
    "    StructField(\"name_seller_industry\", StringType(), True),\n",
    "    StructField(\"cnt_payment\", IntegerType(), True),\n",
    "    StructField(\"name_yield_group\", StringType(), True),\n",
    "    StructField(\"product_combination\", StringType(), True),\n",
    "    StructField(\"days_first_drawing\", IntegerType(), True),\n",
    "    StructField(\"days_first_due\", IntegerType(), True),\n",
    "    StructField(\"days_last_due_1st_version\", IntegerType(), True),\n",
    "    StructField(\"days_last_due\", IntegerType(), True),\n",
    "    StructField(\"days_termination\", IntegerType(), True),\n",
    "    StructField(\"nflag_insured_on_approval\", BooleanType(), True),\n",
    "    StructField(\"id\", IntegerType(), True)\n",
    "\n",
    "])\n",
    "\n",
    "value_dict_schema = StructType([\n",
    "        StructField(\"id\", IntegerType(), True),\n",
    "        StructField(\"category\", StringType(), True),\n",
    "        StructField(\"Key\", StringType(), True),\n",
    "        StructField(\"Value\", IntegerType(), True)\n",
    "\n",
    "\n",
    "\n",
    "])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_app_data = spark.read.csv(\"application_data.csv\", header=True, schema=application_schema)\n",
    "\n",
    "df_prev_data = spark.read.csv(\"previous_application.csv\", header=True, schema=previous_application_schema)\n",
    "\n",
    "df_value_dict = spark.read.csv(\"value_dict.csv\", header=True, schema=value_dict_schema)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.1.2 Display the schema of all dataframes.**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "root\n",
      " |-- id_app: integer (nullable = true)\n",
      " |-- target: integer (nullable = true)\n",
      " |-- contract_type: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- own_car: string (nullable = true)\n",
      " |-- own_property: string (nullable = true)\n",
      " |-- num_of_children: integer (nullable = true)\n",
      " |-- income_total: float (nullable = true)\n",
      " |-- amt_credit: float (nullable = true)\n",
      " |-- amt_annuity: float (nullable = true)\n",
      " |-- amt_goods_price: float (nullable = true)\n",
      " |-- income_type: string (nullable = true)\n",
      " |-- education_type: string (nullable = true)\n",
      " |-- family_status: string (nullable = true)\n",
      " |-- housing_type: string (nullable = true)\n",
      " |-- region_population_relative: float (nullable = true)\n",
      " |-- days_birth: integer (nullable = true)\n",
      " |-- days_employed: integer (nullable = true)\n",
      " |-- own_car_age: integer (nullable = true)\n",
      " |-- flag_mobile: boolean (nullable = true)\n",
      " |-- flag_emp_phone: boolean (nullable = true)\n",
      " |-- flag_work_phone: boolean (nullable = true)\n",
      " |-- flag_cont_mobile: boolean (nullable = true)\n",
      " |-- flag_phone: boolean (nullable = true)\n",
      " |-- flag_email: boolean (nullable = true)\n",
      " |-- occupation_type: string (nullable = true)\n",
      " |-- cnt_fam_members: integer (nullable = true)\n",
      " |-- weekday_appr_process_start: string (nullable = true)\n",
      " |-- hour_appr_process_start: integer (nullable = true)\n",
      " |-- organization_type: string (nullable = true)\n",
      " |-- credit_score_1: float (nullable = true)\n",
      " |-- credit_score_2: float (nullable = true)\n",
      " |-- credit_score_3: float (nullable = true)\n",
      " |-- days_last_phone_change: float (nullable = true)\n",
      " |-- amt_credit_req_last_hour: integer (nullable = true)\n",
      " |-- amt_credit_req_last_day: integer (nullable = true)\n",
      " |-- amt_credit_req_last_week: integer (nullable = true)\n",
      " |-- amt_credit_req_last_month: integer (nullable = true)\n",
      " |-- amt_credit_req_last_quater: integer (nullable = true)\n",
      " |-- amt_credit_req_last_year: string (nullable = true)\n",
      "\n",
      "root\n",
      " |-- id_app: integer (nullable = true)\n",
      " |-- contract_type: string (nullable = true)\n",
      " |-- amt_annuity: float (nullable = true)\n",
      " |-- amt_application: float (nullable = true)\n",
      " |-- amt_credit: float (nullable = true)\n",
      " |-- amt_down_payment: float (nullable = true)\n",
      " |-- amt_goods_price: float (nullable = true)\n",
      " |-- hour_appr_process_start: integer (nullable = true)\n",
      " |-- rate_down_payment: float (nullable = true)\n",
      " |-- rate_interest_primary: float (nullable = true)\n",
      " |-- rate_interest_privileged: float (nullable = true)\n",
      " |-- name_cash_loan_purpose: string (nullable = true)\n",
      " |-- name_contract_status: string (nullable = true)\n",
      " |-- days_decision: integer (nullable = true)\n",
      " |-- name_payment_type: string (nullable = true)\n",
      " |-- code_reject_reason: string (nullable = true)\n",
      " |-- name_type_suite: string (nullable = true)\n",
      " |-- name_client_type: string (nullable = true)\n",
      " |-- name_goods_category: string (nullable = true)\n",
      " |-- name_portfolio: string (nullable = true)\n",
      " |-- name_product_type: string (nullable = true)\n",
      " |-- channel_type: string (nullable = true)\n",
      " |-- sellerplace_area: integer (nullable = true)\n",
      " |-- name_seller_industry: string (nullable = true)\n",
      " |-- cnt_payment: integer (nullable = true)\n",
      " |-- name_yield_group: string (nullable = true)\n",
      " |-- product_combination: string (nullable = true)\n",
      " |-- days_first_drawing: integer (nullable = true)\n",
      " |-- days_first_due: integer (nullable = true)\n",
      " |-- days_last_due_1st_version: integer (nullable = true)\n",
      " |-- days_last_due: integer (nullable = true)\n",
      " |-- days_termination: integer (nullable = true)\n",
      " |-- nflag_insured_on_approval: boolean (nullable = true)\n",
      " |-- id: integer (nullable = true)\n",
      "\n",
      "root\n",
      " |-- id: integer (nullable = true)\n",
      " |-- category: string (nullable = true)\n",
      " |-- Key: string (nullable = true)\n",
      " |-- Value: integer (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "df_app_data.printSchema()\n",
    "df_prev_data.printSchema()\n",
    "df_value_dict.printSchema()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2 QueryAnalysis  <a class=\"anchor\" name=\"2.2\"></a>\n",
    "Implement the following queries using dataframes. You need to be able to perform operations like filtering, sorting, joining and group by using the functions provided by the DataFrame API.   \n",
    "\n",
    "**2.2.1. alculate the average income for each education_type group, and print the result. (4%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql import functions as F\n",
    "\n",
    "selected_columns = [df_app_data[7], df_app_data[12]]\n",
    "\n",
    "df_selected = df_app_data.select(selected_columns)\n",
    "\n",
    "average_income_by_education = df_selected.groupBy(\"education_type\").agg(F.avg(\"income_total\").alias(\"average_income\"))\n",
    "average_income_by_education = average_income_by_education.orderBy(average_income_by_education.education_type)\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+--------------------+-----------------+\n",
      "|     education_group|   average_income|\n",
      "+--------------------+-----------------+\n",
      "|     Academic degree|         227110.0|\n",
      "|    Higher education|209339.6391128193|\n",
      "|   Incomplete higher|181014.4486888112|\n",
      "|     Lower secondary|128151.7258064516|\n",
      "|Secondary / secon...|155155.7391775319|\n",
      "+--------------------+-----------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "education_type_rows = df_value_dict.filter(df_value_dict['category'] == 'education_type')\n",
    "selected_columns = [education_type_rows[2], education_type_rows[3]]\n",
    "df_selected = education_type_rows.select(selected_columns)\n",
    "\n",
    "\n",
    "df_average_income_by_education = average_income_by_education.join(df_selected,average_income_by_education.education_type==df_selected.Value, how = 'inner')\n",
    "selected_columns = [df_average_income_by_education[2], df_average_income_by_education[1]]\n",
    "df_average_income_by_education = df_average_income_by_education.select(selected_columns)\n",
    "\n",
    "df_average_income_by_education = df_average_income_by_education.withColumnRenamed(\"Key\", \"education_group\")\n",
    "\n",
    "df_sorted_by_education_group = df_average_income_by_education.orderBy(\"education_group\")\n",
    "\n",
    "df_sorted_by_education_group.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.2.2. Find the applicants who made credit requests last year with an average credit score of less than 0.5 from the three credit rating sources. (note: impute null value in credit score with 0.5, not 0). (4%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+--------------+--------------+--------------+------------------------+\n",
      "|id_app|credit_score_1|credit_score_2|credit_score_3|amt_credit_req_last_year|\n",
      "+------+--------------+--------------+--------------+------------------------+\n",
      "|118100|    0.60994226|     0.5884348|          NULL|                    NULL|\n",
      "|110133|     0.7081764|     0.6865754|          NULL|                    NULL|\n",
      "|110215|    0.49497995|    0.58477587|    0.47225335|                     3.0|\n",
      "|194051|          NULL|    0.59620756|     0.6195277|                     1.0|\n",
      "|110368|          NULL|    0.64156574|     0.3996756|                     0.0|\n",
      "|110498|          NULL|    0.14626195|     0.5064842|                     4.0|\n",
      "|110561|    0.13320908|     0.5543784|          NULL|                     0.0|\n",
      "|110836|          NULL|    0.78073716|     0.5797274|                     1.0|\n",
      "|110985|          NULL|    0.19403037|          NULL|                    NULL|\n",
      "|109621|    0.42454174|    0.17806706|    0.59892625|                     2.0|\n",
      "|111097|    0.36556485|    0.53807604|          NULL|                    NULL|\n",
      "|111245|          NULL|     0.6637782|          NULL|                     0.0|\n",
      "|111288|          NULL|     0.6227134|     0.6058363|                     2.0|\n",
      "|165103|          NULL|       0.49916|          NULL|                    NULL|\n",
      "|111444|     0.3018591|    0.24960928|    0.71803284|                     1.0|\n",
      "|111509|    0.78796995|     0.6116159|    0.75839305|                     2.0|\n",
      "|111556|          NULL|    0.22650687|     0.5549468|                     2.0|\n",
      "|111642|          NULL|    0.57945114|    0.73098737|                     1.0|\n",
      "|111869|          NULL|      0.609052|     0.3264752|                     0.0|\n",
      "|158585|    0.59885097|    0.23854771|          NULL|                    NULL|\n",
      "+------+--------------+--------------+--------------+------------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "column_names = [df_app_data.columns[0],df_app_data.columns[30], df_app_data.columns[31], df_app_data.columns[32], df_app_data.columns[-1]]\n",
    "\n",
    "df_averge_cred = df_app_data.select(column_names)\n",
    "\n",
    "df_averge_cred.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+------------------------+-------------------+\n",
      "|id_app|amt_credit_req_last_year|     average_credit|\n",
      "+------+------------------------+-------------------+\n",
      "|110498|                     4.0| 0.3842487335205078|\n",
      "|109621|                     2.0| 0.4005116621653239|\n",
      "|111444|                     1.0|0.42316706975301105|\n",
      "|111556|                     2.0| 0.4271512031555176|\n",
      "|112559|                     1.0|0.48743025461832684|\n",
      "|241004|                     2.0| 0.3531012535095215|\n",
      "|113311|                     3.0| 0.3452615737915039|\n",
      "|185942|                     2.0| 0.3323887785275777|\n",
      "|133489|                     2.0|0.38848479588826496|\n",
      "|135550|                     1.0| 0.4540189901987712|\n",
      "|142311|                     3.0|0.49884045124053955|\n",
      "|147013|                     3.0| 0.4054705301920573|\n",
      "|122935|                     1.0| 0.4926573435465495|\n",
      "|118061|                     3.0|0.40017688274383545|\n",
      "|118857|                     3.0|0.36548519134521484|\n",
      "|118986|                     5.0| 0.3944098949432373|\n",
      "|119521|                     2.0|0.45552992820739746|\n",
      "|119681|                     3.0|0.49811895688374835|\n",
      "|120418|                     5.0|  0.483059565226237|\n",
      "|120673|                     2.0|0.47502708435058594|\n",
      "+------+------------------------+-------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "null_col = [df_averge_cred.columns[0],df_averge_cred.columns[1], df_averge_cred.columns[2], df_averge_cred.columns[3]]\n",
    "column_names = [df_app_data.columns[0],df_app_data.columns[30], df_app_data.columns[31], df_app_data.columns[32], df_app_data.columns[-1]]\n",
    "\n",
    "\n",
    "df_selected = df_app_data.select(column_names)\n",
    "\n",
    "df_imputed = df_selected.na.fill(0.5, subset=null_col)\n",
    "\n",
    "df_with_average = df_imputed.withColumn(\n",
    "    \"average_credit\", \n",
    "    (col(column_names[1]) + col(column_names[2]) + col(column_names[3])) / 3\n",
    ")\n",
    "\n",
    "column_names = [df_with_average.columns[0],df_with_average.columns[-2],df_with_average.columns[-1]]\n",
    "\n",
    "df_with_average = df_with_average.select(column_names)\n",
    "\n",
    "df_with_average = df_with_average.filter(df_with_average['average_credit'] < 0.5)\n",
    "\n",
    "df_with_average = df_with_average.filter(df_with_average['amt_credit_req_last_year'] > 0.0)\n",
    "\n",
    "df_with_average.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.2.3. Transform the 'days_birth' column in the application_data to age(integer rounded down) and date_of_birth; then show the schema. You are allowed to use the UDF defined in part 1. (4%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+----------+---+-------------+\n",
      "|days_birth|age|date_of_birth|\n",
      "+----------+---+-------------+\n",
      "|    -11258| 30|   1993-04-19|\n",
      "|    -11044| 30|   1993-11-19|\n",
      "|    -17115| 46|   1977-03-19|\n",
      "|    -17855| 48|   1975-03-19|\n",
      "|    -22818| 62|   1961-08-19|\n",
      "|    -21183| 57|   1966-02-19|\n",
      "|     -9537| 26|   1997-12-19|\n",
      "|    -13351| 36|   1987-07-19|\n",
      "|    -16847| 46|   1977-12-19|\n",
      "|    -10828| 29|   1994-06-19|\n",
      "|    -18279| 50|   1974-01-19|\n",
      "|    -19710| 53|   1970-02-19|\n",
      "|    -11636| 31|   1992-03-19|\n",
      "|    -12011| 32|   1991-03-19|\n",
      "|    -13402| 36|   1987-05-19|\n",
      "|    -19869| 54|   1969-09-19|\n",
      "|    -17096| 46|   1977-04-19|\n",
      "|    -17354| 47|   1976-07-19|\n",
      "|    -21198| 58|   1966-01-19|\n",
      "|    -11897| 32|   1991-07-19|\n",
      "+----------+---+-------------+\n",
      "only showing top 20 rows\n",
      "\n",
      "root\n",
      " |-- id_app: integer (nullable = true)\n",
      " |-- target: integer (nullable = true)\n",
      " |-- contract_type: string (nullable = true)\n",
      " |-- gender: string (nullable = true)\n",
      " |-- own_car: string (nullable = true)\n",
      " |-- own_property: string (nullable = true)\n",
      " |-- num_of_children: integer (nullable = true)\n",
      " |-- income_total: float (nullable = true)\n",
      " |-- amt_credit: float (nullable = true)\n",
      " |-- amt_annuity: float (nullable = true)\n",
      " |-- amt_goods_price: float (nullable = true)\n",
      " |-- income_type: string (nullable = true)\n",
      " |-- education_type: string (nullable = true)\n",
      " |-- family_status: string (nullable = true)\n",
      " |-- housing_type: string (nullable = true)\n",
      " |-- region_population_relative: float (nullable = true)\n",
      " |-- days_birth: integer (nullable = true)\n",
      " |-- days_employed: integer (nullable = true)\n",
      " |-- own_car_age: integer (nullable = true)\n",
      " |-- flag_mobile: boolean (nullable = true)\n",
      " |-- flag_emp_phone: boolean (nullable = true)\n",
      " |-- flag_work_phone: boolean (nullable = true)\n",
      " |-- flag_cont_mobile: boolean (nullable = true)\n",
      " |-- flag_phone: boolean (nullable = true)\n",
      " |-- flag_email: boolean (nullable = true)\n",
      " |-- occupation_type: string (nullable = true)\n",
      " |-- cnt_fam_members: integer (nullable = true)\n",
      " |-- weekday_appr_process_start: string (nullable = true)\n",
      " |-- hour_appr_process_start: integer (nullable = true)\n",
      " |-- organization_type: string (nullable = true)\n",
      " |-- credit_score_1: float (nullable = true)\n",
      " |-- credit_score_2: float (nullable = true)\n",
      " |-- credit_score_3: float (nullable = true)\n",
      " |-- days_last_phone_change: float (nullable = true)\n",
      " |-- amt_credit_req_last_hour: integer (nullable = true)\n",
      " |-- amt_credit_req_last_day: integer (nullable = true)\n",
      " |-- amt_credit_req_last_week: integer (nullable = true)\n",
      " |-- amt_credit_req_last_month: integer (nullable = true)\n",
      " |-- amt_credit_req_last_quater: integer (nullable = true)\n",
      " |-- amt_credit_req_last_year: string (nullable = true)\n",
      " |-- age: long (nullable = true)\n",
      " |-- date_of_birth: date (nullable = true)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from pyspark.sql.functions import lit, current_date, expr, floor\n",
    "\n",
    "# Calculate age in years and create a new column 'age'\n",
    "df_app_data = df_app_data.withColumn(\"age\", floor(col(\"days_birth\") / -365.25))\n",
    "\n",
    "# Calculate the date of birth and create a new column 'date_of_birth'\n",
    "df_app_data = df_app_data.withColumn(\"date_of_birth\", expr(\"add_months(current_date(), (days_birth / 365.25 * 12))\").cast(DateType()))\n",
    "\n",
    "# Show the result\n",
    "df_app_data.select(\"days_birth\", \"age\", \"date_of_birth\").show()\n",
    "df_app_data.printSchema()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.2.4. Using an age bucket of 10(0-10, 11-20, 21-30, etc..), compute the percentage of applicants owning a car and a property. (8%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------+---+\n",
      "|own_car|own_property|age|\n",
      "+-------+------------+---+\n",
      "|      Y|           Y| 30|\n",
      "|      N|           Y| 30|\n",
      "|      N|           Y| 46|\n",
      "|      N|           N| 48|\n",
      "|      N|           Y| 62|\n",
      "|      N|           N| 57|\n",
      "|      N|           Y| 26|\n",
      "|      N|           N| 36|\n",
      "|      N|           Y| 46|\n",
      "|      N|           N| 29|\n",
      "|      Y|           Y| 50|\n",
      "|      N|           N| 53|\n",
      "|      N|           Y| 31|\n",
      "|      N|           Y| 32|\n",
      "|      Y|           N| 36|\n",
      "|      Y|           Y| 54|\n",
      "|      Y|           Y| 46|\n",
      "|      N|           Y| 47|\n",
      "|      N|           Y| 58|\n",
      "|      N|           N| 32|\n",
      "+-------+------------+---+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from pyspark.ml.feature import Bucketizer\n",
    "\n",
    "selected_columns = [df_app_data[4], df_app_data[5],df_app_data[-2]]\n",
    "\n",
    "df_selected = df_app_data.select(selected_columns)\n",
    "df_selected.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [],
   "source": [
    "from pyspark.sql.functions import when\n",
    "\n",
    "def define_age_bin(age_col):\n",
    "    return when((col(age_col) >= 0) & (col(age_col) <= 10), \"0-10\")\\\n",
    "            .when((col(age_col) >= 11) & (col(age_col) <= 20), \"11-20\")\\\n",
    "            .when((col(age_col) >= 21) & (col(age_col) <= 30), \"21-30\")\\\n",
    "            .when((col(age_col) >= 31) & (col(age_col) <= 40), \"31-40\")\\\n",
    "            .when((col(age_col) >= 41) & (col(age_col) <= 50), \"41-50\")\\\n",
    "            .when((col(age_col) >= 51) & (col(age_col) <= 60), \"51-60\")\\\n",
    "            .when((col(age_col) >= 61) & (col(age_col) <= 70), \"61-70\")\\\n",
    "            .when((col(age_col) >= 71) & (col(age_col) <= 80), \"71-80\")\\\n",
    "            .when((col(age_col) >= 81) & (col(age_col) <= 90), \"81-90\")\\\n",
    "            .when((col(age_col) >= 91) & (col(age_col) <= 100), \"91-100\")\\\n",
    "            .otherwise(\"100+\")\n",
    "\n",
    "df_selected = df_selected.withColumn(\"age_bin\", define_age_bin(\"age\"))\n",
    "\n",
    "df_total_own = df_selected.groupBy(\"age_bin\").agg(F.count(\"*\"))\n",
    "\n",
    "df_total_own = df_total_own.withColumnRenamed(\"count(1)\", \"Total\")\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df_car_prop_own = df_selected.filter((df_selected['own_car'] == 'Y') & (df_selected['own_property'] == 'Y'))\n",
    "\n",
    "df_car_prop_own1 = df_car_prop_own.groupBy(\"age_bin\").agg(F.count(\"*\"))\n",
    "df_car_prop_own1 = df_car_prop_own1.withColumnRenamed(\"age_bin\", \"age_bin1\")\n",
    "\n",
    "df_car_prop_own1 = df_car_prop_own1.withColumnRenamed(\"count(1)\", \"Total1\")\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+-------+------------------------+\n",
      "|age_bin|percent_property_car_own|\n",
      "+-------+------------------------+\n",
      "|  21-30|      0.2331826552821028|\n",
      "|  41-50|     0.26805088814210276|\n",
      "|  31-40|     0.26928989282206756|\n",
      "|  51-60|     0.20193604697294296|\n",
      "|  61-70|     0.13922894207929837|\n",
      "+-------+------------------------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "df_combined = df_car_prop_own1.join(df_total_own,df_car_prop_own1.age_bin1==df_total_own.age_bin, how = 'inner')\n",
    "\n",
    "column_name_1 = df_combined.columns[1]  \n",
    "column_name_3 = df_combined.columns[3]  \n",
    "\n",
    "df_combined_percent = df_combined.withColumn(\n",
    "    \"percent_property_car_own\", \n",
    "    (col(column_name_1) / col(column_name_3))\n",
    ")\n",
    "\n",
    "\n",
    "selected_columns = [df_combined_percent[2], df_combined_percent[-1]]\n",
    "\n",
    "df_combined_percent = df_combined_percent.select(selected_columns)\n",
    "\n",
    "\n",
    "df_combined_percent.show()\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.2.5. Draw a barchart to show the total number of uncancelled applications from male/female in each year. (10%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+--------------------+-------------+----------------+-------------+----+\n",
      "|id_app|name_contract_status|days_decision|application_date|decision_date|Year|\n",
      "+------+--------------------+-------------+----------------+-------------+----+\n",
      "|107678|             Refused|        -1252|      2024-01-01|   2020-07-28|2020|\n",
      "|168941|            Approved|         -633|      2024-01-01|   2022-04-08|2022|\n",
      "|204082|             Refused|         -368|      2024-01-01|   2022-12-29|2022|\n",
      "|148658|             Refused|         -419|      2024-01-01|   2022-11-08|2022|\n",
      "|190200|             Refused|         -405|      2024-01-01|   2022-11-22|2022|\n",
      "|162831|             Refused|          -23|      2024-01-01|   2023-12-09|2023|\n",
      "|140789|             Refused|         -183|      2024-01-01|   2023-07-02|2023|\n",
      "|197584|             Refused|        -1435|      2024-01-01|   2020-01-27|2020|\n",
      "|197214|             Refused|         -396|      2024-01-01|   2022-12-01|2022|\n",
      "|241694|             Refused|         -122|      2024-01-01|   2023-09-01|2023|\n",
      "|190933|             Refused|         -279|      2024-01-01|   2023-03-28|2023|\n",
      "|261281|             Refused|         -707|      2024-01-01|   2022-01-24|2022|\n",
      "|279697|            Approved|         -192|      2024-01-01|   2023-06-23|2023|\n",
      "|185175|            Approved|         -343|      2024-01-01|   2023-01-23|2023|\n",
      "|234211|             Refused|         -490|      2024-01-01|   2022-08-29|2022|\n",
      "|205878|            Approved|        -2698|      2024-01-01|   2016-08-12|2016|\n",
      "|266324|             Refused|         -230|      2024-01-01|   2023-05-16|2023|\n",
      "|179126|             Refused|        -1485|      2024-01-01|   2019-12-08|2019|\n",
      "|291118|            Approved|         -326|      2024-01-01|   2023-02-09|2023|\n",
      "|290062|             Refused|         -335|      2024-01-01|   2023-01-31|2023|\n",
      "+------+--------------------+-------------+----------------+-------------+----+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "from pyspark.sql.functions import to_date, year\n",
    "\n",
    "selected_columns = [df_prev_data[0], df_prev_data[12], df_prev_data[13]]  \n",
    "df_app_status = df_prev_data.select(selected_columns)\n",
    "\n",
    "df_app_status_filtered = df_app_status.filter(df_app_status[df_prev_data.columns[12]] != 'Canceled')\n",
    "\n",
    "df_app_status_filtered = df_app_status_filtered.withColumn(\"application_date\", lit(\"2024-01-01\").cast(DateType()))\n",
    "\n",
    "df_with_new_date = df_app_status_filtered.withColumn(\"decision_date\", expr(\"date_add(application_date, days_decision)\"))\n",
    "\n",
    "df_with_new_date = df_with_new_date.withColumn(\"Year\", year(col(\"decision_date\")))\n",
    "\n",
    "df_with_new_date.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [],
   "source": [
    "selected_columns = [df_app_data.columns[0], df_app_data.columns[3]]\n",
    "df_app_gender = df_app_data.select(selected_columns)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+----+------+\n",
      "|gender|Year| count|\n",
      "+------+----+------+\n",
      "|     F|2016| 26077|\n",
      "|     F|2017| 32100|\n",
      "|     F|2018| 26452|\n",
      "|     F|2019| 32654|\n",
      "|     F|2020| 42501|\n",
      "|     F|2021| 67022|\n",
      "|     F|2022|102912|\n",
      "|     F|2023|104288|\n",
      "|     M|2016| 13192|\n",
      "|     M|2017| 15678|\n",
      "|     M|2018| 12824|\n",
      "|     M|2019| 15486|\n",
      "|     M|2020| 20197|\n",
      "|     M|2021| 33106|\n",
      "|     M|2022| 51859|\n",
      "|     M|2023| 49086|\n",
      "+------+----+------+\n",
      "\n"
     ]
    }
   ],
   "source": [
    "df_combined = df_with_new_date.join(df_app_gender,df_with_new_date.id_app==df_app_gender.id_app, how = 'inner')\n",
    "\n",
    "selected_columns = [df_combined.columns[-1], df_combined.columns[5], df_combined.columns[1]]\n",
    "\n",
    "df_gender_contract = df_combined.select(selected_columns)\n",
    "\n",
    "df_gender_contract_grouped = df_gender_contract.groupBy(\"gender\", \"Year\").count()\n",
    "\n",
    "df_gender_contract_grouped = df_gender_contract_grouped.filter(col(df_gender_contract_grouped.columns[0]) != 'XNA')\n",
    "\n",
    "df_gender_contract_sorted = df_gender_contract_grouped.orderBy(\"gender\", \"Year\")\n",
    "\n",
    "df_gender_contract_sorted.show()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAA20AAAIhCAYAAADdH1JpAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjguMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8g+/7EAAAACXBIWXMAAA9hAAAPYQGoP6dpAABg7UlEQVR4nO3deZyN9f//8ecx+wxzzIxm09hKoqFsH4aKMoYYKm0fo8meIktRaEVFdp8vkSQUmuqDFmmiLCX7ZGRLESEziDFjnRkz798f/eZ8nNlss1zyuN9u53Zzrut1ruv9fp9lztP7uq5jM8YYAQAAAAAsqUxpNwAAAAAAUDBCGwAAAABYGKENAAAAACyM0AYAAAAAFkZoAwAAAAALI7QBAAAAgIUR2gAAAADAwghtAAAAAGBhhDYAAAAAsDBCG/5xhg0bJpvNpr/++ivf9eHh4WrevHnJNspCZs+eLZvNpn379jmWdenSRVWqVCnS/TRv3tzy41xSY3GhJUuWaNiwYfmuq1Klirp06VJs+y7IypUrZbPZHDd3d3fdcMMNatq0qV566SX98ccfeR6T39hdipEjR+qzzz67rMfkt6/mzZsrPDz8srZzMVZ8bnL6vmnTpmLdT87nZpkyZfT777/nWX/69Gn5+vrKZrNd8TiU1hgWBZvNVuBrI8e+ffuc3kcX3ho0aFAyDb0C18JndXE4dOiQhg0bpsTExDzrunTporJlyxbbvjMzM1W3bl1VqVJFJ0+ezLN+9+7d8vHxUceOHYutDbj2ENoA4AKvvPKKFi1aVGzbX7JkiYYPH57vukWLFumVV14ptn1fzMiRI7V27VqtWLFCM2fOVPPmzfX++++rZs2amjdvnlNt27ZttXbtWoWEhFz2Pi43tF3pvi6XlZ+bklK2bFnNmjUrz/JPP/1UmZmZcnNzK4VWXVv69u2rtWvXOt1mz55d2s1CLocOHdLw4cPzDW3Fzc3NTR9++KGSk5M1cOBAp3XZ2dnq2rWr7Ha73n777RJvG6zLtbQbAABWctNNN5XavuvWrVtq+5ak6tWrq3Hjxo777du318CBAxUZGakuXbqoTp06ql27tiTphhtu0A033FCs7Tl79qw8PT1LZF8XU9rPTUl57LHHNGfOHA0fPlxlyvzv/3VnzpypBx98UF988UUptu7aUKlSJaf3EUpPzmeIzWYr7abkER4erhEjRmjw4MF66KGH1KpVK0nSpEmTtHr1an311Vfy9/cv9nZkZmbKZrPJ1ZVIYHXMtOG6l3No2EcffaSXXnpJoaGh8vX1VWRkpHbt2pWnPj4+Xi1atJDdbpe3t7dq1qypUaNGOdZv2rRJ//73v1WlShV5eXmpSpUq6tixY55DzHIOe1qxYoWefvppVahQQQEBAerQoYMOHTqUZ7/z589XRESEypYtq7Jly+qOO+7QzJkznWq+/fZbtWjRQr6+vvL29lbTpk313XffXdG4GGM0depU3XHHHfLy8pKfn58efvjhPIdOGWM0ZswYVa5cWZ6enqpXr56+/vrrS97P22+/rbvvvluBgYHy8fFR7dq1NWbMGGVmZjrV5RwO98MPP6hx48by8vJSxYoV9corrygrK8tRl3OI0pgxY/Tmm2+qUqVK8vT0VIMGDS5pLPI7PDI7O1uTJ092jEX58uXVuHFjpy+wH3/8saKiohQSEiIvLy/VrFlTQ4YM0enTp522nfM/pxceOpVz2F9+h4/t379fjz/+uAIDA+Xh4aGaNWtq/Pjxys7OztPncePGacKECapatarKli2riIgIrVu37qJ9Loy/v7+mT5+u8+fPa+LEiY7l+R2yuHnzZkVHRzvaGhoaqrZt2+rgwYOOPp8+fVpz5sxx9D3nsKyc7S1dulTdunXTDTfcIG9vb6Wnpxd6KObFXg857++VK1c6PS5nzHJmQKz+3KSkpKhr167y9/eXj4+P2rVr5/RefP311+Xq6qoDBw7keWy3bt0UEBCgc+fOXXQ/3bp104EDB7Rs2TLHsl9//VWrV69Wt27d8tSfO3dOAwcO1B133CG73S5/f39FRETo888/v6R+paWladCgQapatarc3d1VsWJFDRgwwOl9U5Bly5bp/vvv14033ihPT0/dfPPN6tWrV55D43MO/dy+fbs6duwou92uoKAgdevWTampqXna07NnTwUEBKhs2bJq3bq1fv3110vqy6XatGmT2rdvL39/f3l6eqpu3br65JNPnGpyXvPLly93tMfX11dPPPGETp8+reTkZD366KMqX768QkJCNGjQoDyfmcOHD1ejRo3k7+8vX19f1atXTzNnzpQx5qJtzMjI0BtvvKFbb71VHh4euuGGG9S1a1cdPXr0kvr4xRdfKCIiQt7e3ipXrpxatmyptWvXOtZ/9tlnstls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1K1b12ld7jEcNWqUKVOmjNm4caNT3X//+18jySxZsqTQNl8o5z33xx9/5Hld5PRtzJgxTo/p3bu38fT0dHyef/3110aS0+e0Mca8+eabRpJ57bXXCm1DznOd323ZsmXGGGNuvfVWU7duXZOZmen02OjoaBMSEmKysrKMMf973vv27etU98ADDxhJZsKECU7L77jjDlOvXr0C25bz2TpixAgTEBDg9DesWbNmTp/VH330kZFkFixY4LSNjRs3Gklm6tSphe4nNDTU1K5d29EXY/7++xkYGGiaNGniWPbcc88ZLy8vc+LECceyHTt2GElm8uTJjmWXO2b5fYbkJ6c/F34G5OjcubORZD755BOn5W3atDE1atRw3L+asbrQ1KlTjSRTpkwZs2rVKmPM5f1dz+38+fMmIyPDVK9e3Tz77LOO5Tmfh3fffXeex4SHh5sHHnjgktqL0sFMG/D/tW/f3ul+zv/y5cxmrVmzRmlpaerdu3ehx8efOnVKgwcP1s033yxXV1e5urqqbNmyOn36tHbu3HnZ+122bJmysrLUp0+fAve5Zs0aHT9+XJ07d3b6393s7Gy1bt1aGzduvKTDjXIsXrxYNptNjz/+uNP2goODdfvttzsONVu7dq3OnTunTp06OT2+SZMmqly58iXta/PmzWrfvr0CAgLk4uIiNzc3PfHEE8rKyspzWFK5cuXyjFdMTIyys7PzzAJ16NDBaWahXLlyateunb7//nun2dOLyTnUs7Dxl6Tff/9dMTExCg4OdvSjWbNmkpTv834pli9frlq1aulf//qX0/IuXbrIGKPly5c7LW/btq1cXFwc93O/lq6Gucisx8033yw/Pz8NHjxY77zzjnbs2HFF+3nooYcuufZyXg9FraSfm4LeYytWrHAs69+/v44cOaJPP/1U0t+zANOmTVPbtm0v64qojzzyiNzd3TVv3jwtWbJEycnJhV718dNPP1XTpk1VtmxZubq6ys3NTTNnzrzo637x4sUKDw/XHXfc4fQ506pVq3wPac3tyJEjeuqppxQWFubYb87nzqV+1p47d05HjhyRJMdY5h7rmJiYQtuRW//+/bVx40anW6NGjbR792798ssvju1f2Oc2bdooKSkpz6xIdHS00/2aNWtK+vv1lHt57tfS8uXLFRkZKbvd7vhMevXVV3Xs2DFHn/OzePFilS9fXu3a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QxUrVtT8+fOd/k6ePn1aCxYscFxRMkfHjh3l6emp2bNna/bs2apYsaKioqKctldcY1YURyJczVhdzOX8XbfZbHneC1999ZX+/PPPK9p3UFCQunTpoo4dO2rXrl2OQ1pRuphpwz/OTTfdpGeeeUZjx47ViRMn1KZNG3l5eWnjxo1666231KBBg8s+R0H6+5j88ePHq0ePHoqMjFTPnj0VFBSk3bt3a8uWLZoyZYp8fX119913a+zYsapQoYKqVKmiVatWaebMmfn+b9elqFKlil588UW9/vrrOnv2rOOS1Tt27NBff/2l4cOHq2zZspo8ebI6d+6s48eP6+GHH1ZgYKCOHj2qLVu26OjRo4WGjtyaNm2qJ598Ul27dtWmTZt09913y8fHR0lJSVq9erVq166tp59+Wn5+fho0aJDeeOMN9ejRQ4888ogOHDigYcOGXdIhRS1btpS7u7s6duyoF154QefOndO0adOUkpKSb31AQICefvpp7d+/X7fccouWLFmiGTNm6Omnn1alSpWcal1cXNSyZUs999xzys7O1ujRo5WWllbgjycX5K677lJsbKzeeOMNHT58WNHR0fLw8NDmzZvl7e2tvn37qkmTJvLz89NTTz2l1157TW5ubpo3b562bNmSZ3s5gXf06NG677775OLiojp16uQbqp999ll98MEHatu2rUaMGKHKlSvrq6++0tSpU/X000/rlltuuay+XMxvv/2mdevWKTs7W8eOHdP69es1c+ZMpaWl6YMPPtBtt91W4GMXL16sqVOn6oEHHlC1atVkjNHChQt14sQJp5me2rVra+XKlfryyy8VEhKicuXKXfEXm0t5PQQHBysyMlKjRo2Sn5+fKleurO+++04LFy7Msz0rPzebNm1yeo+99NJLqlixonr37u1U5+Lioj59+mjw4MHy8fEp9Fy0i8n9kyL5iY6O1sKFC9W7d289/PDDOnDggF5//XWFhITot99+K/SxAwYM0IIFC3T33Xfr2WefVZ06dZSdna39+/dr6dKlGjhwoBo1apTvY2+99VbddNNNGjJkiIwx8vf315dffun0UwWXKyoqSnfffbdeeOEFnT59Wg0aNNCPP/54SUHnUk2fPl333XefWrVqpS5duqhixYo6fvy4du7cqZ9++slxPuLVatu2rSZMmKCYmBg9+eSTOnbsmMaNG5fvkRO5/fvf/9a8efPUpk0b9e/fX//617/k5uamgwcPasWKFbr//vsLDPJlypTRmDFj1KlTJ0VHR6tXr15KT093/D1+6623nOrLly+vBx98ULNnz9aJEyc0aNAgp3PhpOIbs5tuukleXl6aN2+eatasqbJlyyo0NLTQw8Bzu5qxupjL+bseHR2t2bNn69Zbb1WdOnWUkJCgsWPHXvR0jgs1atRI0dHRqlOnjvz8/LRz5059+OGHeYI2SlGpXP4EKGbZ2dlm2rRppkGDBsbb29u4u7ub6tWrm8GDB5uTJ0861RZ05bz8ri5njDFLliwxzZo1Mz4+Psbb29vUqlXLjB492rH+4MGD5qGHHjJ+fn6mXLlypnXr1mbbtm15rpyWc6Wr3FdOK+hqdx988IFp2LCh8fT0NGXLljV169bN07ZVq1aZtm3bGn9/f+Pm5mYqVqxo2rZt69S3S7liYo7333/fNGrUyPj4+BgvLy9z0003mSeeeMJs2rTJaaxHjRplwsLCjLu7u6lTp4758ssv81yRrCBffvmluf32242np6epWLGief755x1XcbtwDJo1a2Zuu+02s3LlStOgQQPj4eFhQkJCzIsvvuh0VbGc52306NFm+PDh5sYbbzTu7u6mbt265ptvvnHa96WORVZWlpk4caIJDw837u7uxm63m4iICPPll186atasWWMiIiKMt7e3ueGGG0yPHj3MTz/9lOc1lJ6ebnr06GFuuOEGY7PZnPaf+zVijDF//PGHiYmJMQEBAcbNzc3UqFHDjB071unKbDl9Hjt2bJ7x1SVc9S7nNZdzc3V1NQEBASYiIsK8+OKLZt++fXkek3vsfvnlF9OxY0dz0003GS8vL2O3282//vUvM3v2bKfHJSYmmqZNmxpvb2+nK4wW9H7Ib1/GXPrrwRhjkpKSzMMPP2z8/f2N3W43jz/+uONql1Z/bnL6vnTpUhMbG2vKly9vvLy8TJs2bcxvv/2W72P27dtnJJmnnnqq0G1f6GJX3c2R39Uj33rrLVOlShXj4eFhatasaWbMmOHY3oXyG8NTp06Zl19+2dSoUcPx3qpdu7Z59tlnTXJycqFt2bFjh2nZsqUpV66c8fPzM4888ojZv39/nnEtqG/5va5OnDhhunXrZsqXL2+8vb1Ny5YtzS+//HJZV4/M77m+0JYtW8yjjz5qAgMDjZubmwkODjb33nuveeedd/K0Lff7oaC+dO7c2fj4+Dgte//9902NGjWMh4eHqVatmhk1apSZOXNmvu+l3J/VmZmZZty4cY7P5rJly5pbb73V9OrVq8DX3YU+++wz06hRI+Pp6Wl8fHxMixYtzI8//phv7dKlSx2fPb/++mu+NVczZoX56KOPzK233mrc3NycnuP8xtMYk+/r+mrHKkflypVN27Zt8yy/lL/rKSkppnv37iYwMNB4e3ubO++80/zwww95ntvCrhQ8ZMgQ06BBA+Pn5+d4zTz77LPmr7/+uuQ+oHjZjLmEX1kEgFLWvHlz/fXXX9q2bVuhdfv27VPVqlU1duzYAk9cB/7JJk+erH79+mnbtm2Fzo4CAK4dHB4JAMA/wObNm7V3716NGDFC999/P4ENAP5BCG0AAPwDPPjgg0pOTtZdd92ld955p7SbAwAoQhweCQAAAAAWxiX/AQAAAMDCCG0AAAAAYGGENgAAAACwMC5EUsKys7N16NAhlStXTjabrbSbAwAAAKCUGGN08uRJhYaG5vlx+QsR2krYoUOHFBYWVtrNAAAAAGARBw4c0I033ljgekJbCStXrpykv58YX1/fUm4NAAAAgNKSlpamsLAwR0YoCKGthOUcEunr60toAwAAAHDR06a4EAkAAAAAWBihDQAAAAAsjNAGAAAAABbGOW0WY4zR+fPnlZWVVdpNua65uLjI1dWVn2UAAABAqSO0WUhGRoaSkpJ05syZ0m4KJHl7eyskJETu7u6l3RQAAABcxwhtFpGdna29e/fKxcVFoaGhcnd3Z5anlBhjlJGRoaNHj2rv3r2qXr16oT92CAAAABQnQptFZGRkKDs7W2FhYfL29i7t5lz3vLy85Obmpj/++EMZGRny9PQs7SYBAADgOsX0gcUwo2MdPBcAAACwAr6VAgAAAICFEdoAAAAAwMIIbdcAm61kb6Vp3759stlsSkxMLN2GAAAAABZBaMNV69Kli2w2m5566qk863r37i2bzaYuXbqUfMMAAACAfwBCG4pEWFiY4uLidPbsWceyc+fO6aOPPlKlSpVKsWUAAADAtY3QhiJRr149VapUSQsXLnQsW7hwocLCwlS3bl3Hsvj4eN15550qX768AgICFB0drT179hS67R07dqhNmzYqW7asgoKCFBsbq7/++qvY+gIAAABYCaENRaZr166aNWuW4/77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+vjx4+rbt69q1Kghb29vVapUSf369VNqaqrTdlJSUhQbGyu73S673a7Y2NgCP9//qUpyvN988001adJE3t7eKl++fEl0z1JKaqz37dun7t27q2rVqvLy8tJNN92k1157TRkZGSXWVysoydd2+/btValSJXl6eiokJESxsbE6dOhQifTTSghtuGKrVq1Snz59tG7dOi1btkznz59XVFSUTp8+7agZM2aMJkyYoClTpmjjxo0KDg5Wy5YtdfLkSUfNmTNn1Lp1a7344osF7mvBggWKjY1V165dtWXLFv3444+KiYkp1v5ZTUmNd5MmTZSUlOR069Gjh6pUqaIGDRoUez+toCRf223bttX58+e1fPlyJSQk6I477lB0dLSSk5OLtY9WUlLjfejQIUVGRurmm2/W+vXrFR8fr+3bt6tLly7F3UXLKIqxPnTokA4dOqRx48Zp69atmj17tuLj49W9e3enfcXExCgxMVHx8fGKj49XYmKiYmNjS7S/pa0kxzsjI0OPPPKInn766RLto1WU1Fj/8ssvys7O1vTp07V9+3ZNnDhR77zzTqGf8/9EJfnavueee/TJJ59o165dWrBggfbs2aOHH364RPtrCQYoIkeOHDGSzKpVq4wxxmRnZ5vg4GDz1ltvOWrOnTtn7Ha7eeedd/I8fsWKFUaSSUlJcVqemZlpKlasaN57771ibf+1prjGO7eMjAwTGBhoRowYUaTtv5YU11gfPXrUSDLff/+9Y1laWpqRZL799tvi6cw1oLjGe/r06SYwMNBkZWU5lm3evNlIMr/99lvxdMbirnasc3zyySfG3d3dZGZmGmOM2bFjh5Fk1q1b56hZu3atkWR++eWXYuqN9RXXeF9o1qxZxm63F3nbrzUlMdY5xowZY6pWrVp0jb8GleR4f/7558Zms5mMjIyi68A1gJk2FJmc6Wx/f39J0t69e5WcnKyoqChHjYeHh5o1a6Y1a9Zc8nZ/+ukn/fnnnypTpozq1q2rkJAQ3XfffXkOjbreFNd45/bFF1/or7/+uq5mI3IrrrEOCAhQzZo19cEHH+j06dM6f/68pk+frqCgINWvX79oO3ENKa7xTk9Pl7u7u8qU+d+fPi8vL0nS6tWri6Lp15yiGuvU1FT5+vrK1dVVkrR27VrZ7XY1atTIUdO4cWPZ7far+jy61hXXeCOvkhzr1NRUx36uVyU13sePH9e8efPUpEkTubm5FWEPrI/QhiJhjNFzzz2nO++8U+Hh4ZLkOLwrKCjIqTYoKOiyDv36/fffJUnDhg3Tyy+/rMWLF8vPz0/NmjXT8ePHi6gH15biHO/cZs6cqVatWiksLOzKG3wNK86xttlsWrZsmTZv3qxy5crJ09NTEydOVHx8/HV5TopUvON97733Kjk5WWPHjlVGRoZSUlIchzQlJSUVUQ+uHUU11seOHdPrr7+uXr16OZYlJycrMDAwT21gYOB1dejvhYpzvOGsJMd6z549mjx5sp566qkiav21pyTGe/DgwfLx8VFAQID279+vzz//vIh7YX2ENhSJZ555Rj///LM++uijPOtsNpvTfWNMnmWFyc7OliS99NJLeuihh1S/fn3NmjVLNptNn3766dU1/BpVnON9oYMHD+qbb77Jc3z59aQ4x9oYo969eyswMFA//PCDNmzYoPvvv1/R0dHXZYiQine8b7vtNs2ZM0fjx4+Xt7e3goODVa1aNQUFBcnFxeWq236tKYqxTktLU9u2bVWrVi299tprhW6jsO1cD4p7vPE/JTXWhw4dUuvWrfXII4+oR48eRdP4a1BJjPfzzz+vzZs3a+nSpXJxcdETTzwhY0zRdeIaQGjDVevbt6+++OILrVixQjfeeKNjeXBwsCTl+R+VI0eO5Pmfl8KEhIRIkmrVquVY5uHhoWrVqmn//v1X0/RrUnGP94VmzZqlgIAAtW/f/sobfA0r7rFevny5Fi9erLi4ODVt2lT16tXT1KlT5eXlpTlz5hRNJ64hJfHajomJUXJysv78808dO3ZMw4YN09GjR1W1atWr78A1pCjG+uTJk2rdurXKli2rRYsWOR2qFBwcrMOHD+fZ79GjR6/48+haVtzjjf8pqbE+dOiQ7rnnHkVEROjdd98thp5cG0pqvCtUqKBbbrlFLVu2VFxcnJYsWaJ169YVQ4+si9CGK2aM0TPPPKOFCxdq+fLleb70VK1aVcHBwVq2bJljWUZGhlatWqUmTZpc8n7q168vDw8Pp0vJZmZmat++fapcufLVd+QaUVLjfeH+Zs2apSeeeOK6+3JQUmN95swZSXI6xyrnfs4M8/WgpF/b0t+H6JQtW1Yff/yxPD091bJly6vqw7WiqMY6LS1NUVFRcnd31xdffCFPT0+n7URERCg1NVUbNmxwLFu/fr1SU1Ov+Dm7FpXUeKNkx/rPP/9U8+bNVa9ePc2aNSvPZ/j1oDRf2zkzbOnp6UXUm2tEiVzuBP9ITz/9tLHb7WblypUmKSnJcTtz5oyj5q233jJ2u90sXLjQbN261XTs2NGEhISYtLQ0R01SUpLZvHmzmTFjhuNKeps3bzbHjh1z1PTv399UrFjRfPPNN+aXX34x3bt3N4GBgeb48eMl2ufSVJLjbYwx3377rZFkduzYUWJ9tIqSGuujR4+agIAA06FDB5OYmGh27dplBg0aZNzc3ExiYmKJ97u0lORre/LkySYhIcHs2rXLTJkyxXh5eZn//Oc/Jdrf0lQUY52WlmYaNWpkateubXbv3u20nfPnzzu207p1a1OnTh2zdu1as3btWlO7dm0THR1d4n0uTSU53n/88YfZvHmzGT58uClbtqzZvHmz2bx5szl58mSJ97s0lNRY//nnn+bmm2829957rzl48KBTzfWkpMZ7/fr1ZvLkyWbz5s1m3759Zvny5ebOO+80N910kzl37lyp9L20ENpwxSTle5s1a5ajJjs727z22msmODjYeHh4mLvvvtts3brVaTuvvfbaRbeTkZFhBg4caAIDA025cuVMZGSk2bZtWwn11BpKcryNMaZjx46mSZMmJdAz6ynJsd64caOJiooy/v7+ply5cqZx48ZmyZIlJdRTayjJ8Y6NjTX+/v7G3d3d1KlTx3zwwQcl1EtrKIqxzvlJhfxue/fuddQdO3bMdOrUyZQrV86UK1fOdOrU6aI/MfJPU5Lj3blz53xrVqxYUXIdLkUlNdazZs0qsOZ6UlLj/fPPP5t77rnH+Pv7Gw8PD1OlShXz1FNPmYMHD5Zwj0ufzZjr7Cw+AAAAALiGXH8H4QIAAADANYTQBgAAAAAWRmgDAAAAAAsjtAEAAACAhRHaAAAAAMDCCG0AAAAAYGGENgAAAACwMEIbAAAAAFgYoQ0AAAAALIzQBgDAFTLGKDIyUq1atcqzburUqbLb7dq/f38ptAwA8E9CaAMA4ArZbDbNmjVL69ev1/Tp0x3L9+7dq8GDB+s///mPKlWqVKT7zMzMLNLtAQCsj9AGAMBVCAsL03/+8x8NGjRIe/fulTFG3bt3V4sWLfSvf/1Lbdq0UdmyZRUUFKTY2Fj99ddfjsfGx8frzjvvVPny5RUQEKDo6Gjt2bPHsX7fvn2y2Wz65JNP1Lx5c3l6emru3Lml0U0AQCmyGWNMaTcCAIBr3QMPPKATJ07ooYce0uuvv66NGzeqQYMG6tmzp5544gmdPXtWgwcP1vnz57V8+XJJ0oIFC2Sz2VS7dm2dPn1ar776qvbt26fExESVKVNG+/btU9WqVVWlShWNHz9edevWlYeHh0JDQ0u5twCAkkRoAwCgCBw5ckTh4eE6duyY/vvf/2rz5s1av369vvnmG0fNwYMHFRYWpl27dumWW27Js42jR48qMDBQW7duVXh4uCO0TZo0Sf379y/J7gAALITDIwEAKAKBgYF68sknVbNmTT344INKSEjQihUrVLZsWcft1ltvlSTHIZB79uxRTEyMqlWrJl9fX1WtWlWS8ly8pEGDBiXbGQCApbiWdgMAAPincHV1lavr339as7Oz1a5dO40ePTpPXUhIiCSpXbt2CgsL04wZMxQaGqrs7GyFh4crIyPDqd7Hx6f4Gw8AsCxCGwAAxaBevXpasGCBqlSp4ghyFzp27Jh27typ6dOn66677pIkrV69uqSbCQC4BnB4JAAAxaBPnz46fvy4OnbsqA0bNuj333/X0qVL1a1bN2VlZcnPz08BAQF69913tXv3bi1fvlzPPfdcaTcbAGBBhDYAAIpBaGiofvzxR2VlZalVq1YKDw9X//79ZbfbVaZMGZUpU0ZxcXFKSEhQeHi4nn32WY0dO7a0mw0AsCCuHgkAAAAAFsZMGwAAAABYGKENAAAAACyM0AYAAAAAFkZoAwAAAAALI7QBAAAAgIUR2gAAAADAwghtAAAAAGBhhDYAAAAAsDBCGwAAAABYGKENAAAAACyM0AYAAAAAFvb/AO6lOUd/3UISAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 1000x600 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "df_pandas = df_gender_contract_sorted.toPandas()\n",
    "\n",
    "df_male = df_pandas[df_pandas['gender'] == 'M']\n",
    "df_female = df_pandas[df_pandas['gender'] == 'F']\n",
    "\n",
    "years = df_pandas['Year'].unique()\n",
    "\n",
    "labels = [str(year) for year in years]\n",
    "\n",
    "male_counts = [df_male[df_male['Year'] == year]['count'].values[0] for year in years]\n",
    "female_counts = [df_female[df_female['Year'] == year]['count'].values[0] for year in years]\n",
    "\n",
    "bar_width = 0.35\n",
    "\n",
    "x = np.arange(len(years))\n",
    "\n",
    "fig, ax = plt.subplots(figsize=(10, 6))\n",
    "bar1 = ax.bar(x - bar_width/2, male_counts, bar_width, label='Male', color='blue')\n",
    "bar2 = ax.bar(x + bar_width/2, female_counts, bar_width, label='Female', color='pink')\n",
    "\n",
    "ax.set_xlabel('Year')\n",
    "ax.set_ylabel('Count')\n",
    "ax.set_title('Uncancelled application Distribution by Male and Female over the Years')\n",
    "ax.set_xticks(x)\n",
    "ax.set_xticklabels(labels)\n",
    "ax.legend()\n",
    "\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**2.2.6. Draw a scatter plot of the applicants age and their total approved credit. You may use log scales for the XY axis if necessary. (10%)**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Applicant age groupy with the sum of apporved credit\n",
    "selected_columns = [df_app_data[0],df_app_data[-2]]\n",
    "\n",
    "df_age_app = df_app_data.select(selected_columns)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+----------+--------------------+\n",
      "|id_app|amt_credit|name_contract_status|\n",
      "+------+----------+--------------------+\n",
      "|168941|   46593.0|            Approved|\n",
      "|279697|  112500.0|            Approved|\n",
      "|185175|  790830.0|            Approved|\n",
      "|205878|   67500.0|            Approved|\n",
      "|291118|   45000.0|            Approved|\n",
      "|239564|  225000.0|            Approved|\n",
      "|214131|   45000.0|            Approved|\n",
      "|223803|   30901.5|            Approved|\n",
      "|231499|  180000.0|            Approved|\n",
      "|151361|  157500.0|            Approved|\n",
      "|125296|  180000.0|            Approved|\n",
      "|104687|  135000.0|            Approved|\n",
      "|262783|   45000.0|            Approved|\n",
      "|112377|  135000.0|            Approved|\n",
      "|128963|       0.0|            Approved|\n",
      "|133840|  675000.0|            Approved|\n",
      "|294632|  450000.0|            Approved|\n",
      "|157170|   90000.0|            Approved|\n",
      "|240039|  157500.0|            Approved|\n",
      "|239167|  405000.0|            Approved|\n",
      "+------+----------+--------------------+\n",
      "only showing top 20 rows\n",
      "\n"
     ]
    }
   ],
   "source": [
    "selected_columns = [df_prev_data[0],df_prev_data[4],df_prev_data[12]]\n",
    "\n",
    "df_amt_loan = df_prev_data.select(selected_columns)\n",
    "df_amt_loan = df_amt_loan.filter(col(df_amt_loan.columns[2]) == 'Approved')\n",
    "\n",
    "df_amt_loan.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "162704"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined = df_age_app.join(df_amt_loan,df_age_app.id_app==df_amt_loan.id_app, how = 'inner')\n",
    "\n",
    "selected_columns = [df_amt_loan[0],df_combined[1],df_combined[3]]\n",
    "\n",
    "df_combined = df_combined.select(selected_columns)\n",
    "\n",
    "df_final = df_combined.groupBy('id_app', 'age').agg(F.sum('amt_credit').alias('sum_amt_credit'))\n",
    "\n",
    "df_final.count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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+5tvvpEASL6+vmb/PD09m8zy//rrryVPT08pKyvLjqtufaxZs0a67777pGuuuUby8/OTNBqN1L59e+n++++X0tLSGo1fvny51K9fP0mn00l+fn5Sr169zKp10tLSpOHDh0v+/v5SUFCQdNddd0mZmZkSAGnu3Llmc82ePVuKioqS1Gq1WcVORkaGNGLECMnf399UPmyktLRUevnll6XOnTtLXl5ekl6vl7p16yY988wzUnZ2tmkcrioFVsJSWfrVXF2lJUmSVFFRIc2aNUuKiYmRNBqNFBkZKU2dOlUqKCgwGyf3vZqCOq+oKi1JkqQjR45I48aNk/R6veTl5SX16NGjyWqsVatWSV26dJE0Go3ZsT137px05513SkFBQZK/v780atQoKTU1tVEFFbVK65dffpEefvhhKT4+XtLr9ZKnp6cUGRkp3XHHHVJycrLZWIPBIC1cuFDq0KGDpNPppL59+0qbN2+2WKX17bffmn3eWG5/dRXg3LlzJQBm1UxNYTyHtm7dKvXt21fSarVSZGSk9OKLL0o1NTVmY2tqaqR33nlH6tGjh+m31KVLF+mJJ56QTpw4YRrX1DFqiurqaiksLEzq2bOnxTG1tbVSu3btpG7duple2759u3TDDTdIWq1WioiIkJ5//nnp7bfflgCYqvKM/PDDD9JNN90kBQQESFqtVoqJiZH+9re/Sb/++qvi+hj3RCVJrVD6swlUKhXWrVuH2267DUB9Mt3f//53HD16FB4eHmZj/fz8TIl9Rm6++WYEBARg3bp19loywzBMs7nxxhuRm5trllfkiowYMQIZGRn466+/HL0UxsnhkJYFevXqhbq6OuTk5Cjm5KSnp2PLli2NYuEMwzCMOGbOnIlevXohOjoa+fn5WLlyJZKSkszU0xnGEq3a4CktLTWryElPT0dKSgqCg4Nx7bXX4u9//zsmT56Md999F7169UJubi42b96Mbt26YcyYMabPLVu2DJGRkbIVXwzDMEzLqKurwyuvvILs7GyoVCrEx8fjq6++wqRJkxy9NMYFaNUhra1bt+Kmm25q9PoDDzyAL774AjU1NXj99dexfPlynD9/HiEhIUhMTMT8+fNNyZsGgwExMTGYPHky3njjDXt/BYZhGIZhCLRqg4dhGIZhmNYB6/AwDMMwDOP2sMHDMAzDMIzb0+qSlg0GAy5cuAB/f3+r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",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Convert PySpark DataFrame to Pandas DataFrame\n",
    "pandas_df = df_final.toPandas()\n",
    "\n",
    "# Create a scatter plot\n",
    "plt.scatter(pandas_df['age'], pandas_df['sum_amt_credit'])\n",
    "plt.xlabel('Age')\n",
    "plt.ylabel('Total Sum per Age')\n",
    "plt.title('Scatter Plot of Total Sum per Age')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Part 3 RDDs vs DataFrame vs Spark SQL (15%) <a class=\"anchor\" name=\"part-3\"></a>\n",
    "Implement the following queries using RDDs, DataFrames in SparkSQL separately. Log the time taken for each query in each approach using the %%time built-in magic command in Jupyter Notebook and discuss the performance difference between these three approaches.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Complex Query (high-risk applicants): Find the top 100 applicants who are married with children and have a total approved credit that is more than five times their incomes (regardless of any payments made), sorted by the total credit/income ratio. (hint: intermediate dataframes/tables are allowed if necessary)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.1. RDD Implementation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 69.3 ms, sys: 17.2 ms, total: 86.5 ms\n",
      "Wall time: 13 s\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[('197725', '2', '144000.0', 'Married', '28667205.0', 199.0778125),\n",
       " ('200698', '1', '126000.0', 'Married', '24614455.5', 195.35282142857142),\n",
       " ('104007', '2', '72000.0', 'Married', '11894962.5', 165.2078125),\n",
       " ('191956', '1', '112500.0', 'Married', '16835089.5', 149.64524),\n",
       " ('270489', '1', '112428.0', 'Married', '15650752.5', 139.20689241114314),\n",
       " ('164657', '1', '90000.0', 'Married', '11813940.0', 131.266),\n",
       " ('193609', '1', '112500.0', 'Married', '14275300.5', 126.89156),\n",
       " ('291238', '1', '90000.0', 'Married', '11088486.0', 123.2054),\n",
       " ('256557', '2', '157500.0', 'Married', '18459364.5', 117.20231428571428),\n",
       " ('230165', '2', '90000.0', 'Married', '10461433.5', 116.23815),\n",
       " ('110899', '1', '157500.0', 'Married', '17594428.5', 111.71065714285714),\n",
       " ('107989', '1', '306000.0', 'Married', '32470303.5', 106.11210294117647),\n",
       " ('132204', '1', '148500.0', 'Married', '15283242.0', 102.91745454545455),\n",
       " ('148445', '1', '67500.0', 'Married', '6915298.5', 102.44886666666666),\n",
       " ('192781', '3', '112500.0', 'Married', '11158951.5', 99.19068),\n",
       " ('183693', '1', '135000.0', 'Married', '13383711.0', 99.1386),\n",
       " ('245252', '1', '202500.0', 'Married', '19824759.0', 97.90004444444445),\n",
       " ('133656', '2', '112500.0', 'Married', '10917801.0', 97.04712),\n",
       " ('114628', '2', '63000.0', 'Married', '6080701.5', 96.51907142857142),\n",
       " ('128025', '1', '112500.0', 'Married', '10858320.0', 96.5184),\n",
       " ('268811', '1', '180000.0', 'Married', '17285395.5', 96.029975),\n",
       " ('288483', '1', '112500.0', 'Married', '10537861.5', 93.66988),\n",
       " ('128498', '1', '135000.0', 'Married', '12645000.0', 93.66666666666667),\n",
       " ('102217', '1', '117000.0', 'Married', '10549570.5', 90.16726923076924),\n",
       " ('174637', '1', '270000.0', 'Married', '24048814.5', 89.06968333333333),\n",
       " ('147884', '1', '180000.0', 'Married', '15582379.5', 86.568775),\n",
       " ('263083', '2', '90000.0', 'Married', '7772251.5', 86.35835),\n",
       " ('268731', '2', '90000.0', 'Married', '7633804.5', 84.82005),\n",
       " ('144763', '1', '180000.0', 'Married', '15133243.5', 84.073575),\n",
       " ('122312', '1', '135000.0', 'Married', '11328034.5', 83.91136666666667),\n",
       " ('149258', '2', '225000.0', 'Married', '18840613.5', 83.73606),\n",
       " ('292185', '2', '211500.0', 'Married', '17114166.0', 80.91804255319148),\n",
       " ('226624',\n",
       "  '1',\n",
       "  '112500.0',\n",
       "  'Married',\n",
       "  '8988461.280000001',\n",
       "  79.89743360000001),\n",
       " ('219288', '1', '135000.0', 'Married', '10751859.0', 79.6434),\n",
       " ('137917', '1', '135000.0', 'Married', '10744245.0', 79.587),\n",
       " ('147915', '3', '72000.0', 'Married', '5684764.5', 78.9550625),\n",
       " ('200310', '3', '90000.0', 'Married', '7056540.0', 78.406),\n",
       " ('275973', '2', '112500.0', 'Married', '8775585.0', 78.0052),\n",
       " ('124784', '1', '225000.0', 'Married', '17448799.5', 77.55022),\n",
       " ('112498', '1', '225000.0', 'Married', '17320729.5', 76.98102),\n",
       " ('160583', '1', '157500.0', 'Married', '12098749.5', 76.81745714285714),\n",
       " ('117209', '1', '135000.0', 'Married', '10208763.0', 75.62046666666667),\n",
       " ('138359', '1', '81000.0', 'Married', '6110739.0', 75.44122222222222),\n",
       " ('296869', '1', '139500.0', 'Married', '10480752.0', 75.13083870967742),\n",
       " ('235212', '1', '45000.0', 'Married', '3367729.5', 74.83843333333333),\n",
       " ('252592', '1', '121500.0', 'Married', '9014611.5', 74.19433333333333),\n",
       " ('209975', '2', '157500.0', 'Married', '11617839.0', 73.76405714285714),\n",
       " ('123278', '1', '135000.0', 'Married', '9851521.5', 72.97423333333333),\n",
       " ('173315', '2', '90000.0', 'Married', '6538855.5', 72.65395),\n",
       " ('269658', '1', '211500.0', 'Married', '15271006.5', 72.20334042553192),\n",
       " ('254413', '2', '135000.0', 'Married', '9610740.0', 71.19066666666667),\n",
       " ('290271', '1', '103500.0', 'Married', '7296894.0', 70.50139130434782),\n",
       " ('193444', '1', '135000.0', 'Married', '9424831.5', 69.81356666666667),\n",
       " ('147568', '1', '67500.0', 'Married', '4706523.0', 69.72626666666666),\n",
       " ('298047', '1', '193500.0', 'Married', '13472257.5', 69.62406976744187),\n",
       " ('201859', '1', '135000.0', 'Married', '9352507.5', 69.27783333333333),\n",
       " ('116630', '2', '90000.0', 'Married', '6114415.5', 67.93795),\n",
       " ('217354', '1', '90000.0', 'Married', '6087906.0', 67.6434),\n",
       " ('149849', '1', '189000.0', 'Married', '12678876.0', 67.084),\n",
       " ('285652', '1', '81000.0', 'Married', '5415592.5', 66.85916666666667),\n",
       " ('178554', '1', '103500.0', 'Married', '6879809.3', 66.47158743961353),\n",
       " ('100122', '1', '76500.0', 'Married', '5045436.0', 65.95341176470588),\n",
       " ('211517', '2', '90000.0', 'Married', '5927350.5', 65.85945),\n",
       " ('173219', '2', '135000.0', 'Married', '8877870.0', 65.762),\n",
       " ('208673', '1', '135000.0', 'Married', '8865319.5', 65.66903333333333),\n",
       " ('198265', '1', '54000.0', 'Married', '3519474.75', 65.17545833333334),\n",
       " ('131450', '1', '180000.0', 'Married', '11726419.5', 65.146775),\n",
       " ('134961', '1', '67500.0', 'Married', '4379197.5', 64.877),\n",
       " ('255909', '2', '112500.0', 'Married', '7287300.0', 64.776),\n",
       " ('145843', '2', '94500.0', 'Married', '6098036.85', 64.52949047619047),\n",
       " ('207446', '1', '315000.0', 'Married', '20229097.5', 64.21935714285715),\n",
       " ('285976', '1', '135000.0', 'Married', '8610273.0', 63.7798),\n",
       " ('198096', '1', '157500.0', 'Married', '9964681.92', 63.267821714285716),\n",
       " ('221096', '1', '67500.0', 'Married', '4237906.5', 62.7838),\n",
       " ('149883', '2', '135000.0', 'Married', '8457880.5', 62.65096666666667),\n",
       " ('228508', '1', '90000.0', 'Married', '5596578.0', 62.1842),\n",
       " ('193213', '2', '67500.0', 'Married', '4158454.5', 61.60673333333333),\n",
       " ('263030', '1', '112500.0', 'Married', '6905088.0', 61.37856),\n",
       " ('236519', '1', '202500.0', 'Married', '12402463.5', 61.24673333333333),\n",
       " ('115375', '1', '135000.0', 'Married', '8213850.0', 60.843333333333334),\n",
       " ('149809', '2', '76500.0', 'Married', '4646038.5', 60.73252941176471),\n",
       " ('221377', '1', '135000.0', 'Married', '8159472.0', 60.440533333333335),\n",
       " ('281966', '1', '225000.0', 'Married', '13579044.3', 60.351308),\n",
       " ('299603', '2', '112500.0', 'Married', '6785784.0', 60.31808),\n",
       " ('233676', '2', '67500.0', 'Married', '4023324.0', 59.6048),\n",
       " ('169921', '1', '47191.5', 'Married', '2810673.0', 59.55888242586059),\n",
       " ('272297', '1', '135000.0', 'Married', '8033242.5', 59.5055),\n",
       " ('266003', '1', '112500.0', 'Married', '6690141.0', 59.46792),\n",
       " ('269374', '1', '144000.0', 'Married', '8439745.5', 58.60934375),\n",
       " ('164041', '2', '85500.0', 'Married', '5005521.0', 58.544105263157896),\n",
       " ('171049', '1', '90000.0', 'Married', '5262457.5', 58.47175),\n",
       " ('128388', '1', '90000.0', 'Married', '5256643.5', 58.40715),\n",
       " ('276017', '2', '108000.0', 'Married', '6305616.0', 58.385333333333335),\n",
       " ('180458', '5', '135000.0', 'Married', '7865082.0', 58.25986666666667),\n",
       " ('265883', '2', '351000.0', 'Married', '20356816.5', 57.996628205128204),\n",
       " ('132210', '1', '135000.0', 'Married', '7828222.5', 57.98683333333334),\n",
       " ('282489', '2', '112500.0', 'Married', '6511617.0', 57.88104),\n",
       " ('255496', '1', '225000.0', 'Married', '12995185.5', 57.75638),\n",
       " ('124884', '2', '180000.0', 'Married', '10378134.0', 57.6563),\n",
       " ('200161', '1', '112500.0', 'Married', '6473655.0', 57.5436)]"
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "%%time\n",
    "\n",
    "app_data_rdd1 = app_data_rdd.map(lambda line: next(csv.reader(StringIO(line))))\n",
    "prev_data_rdd1 = prev_data_rdd.map(lambda line: next(csv.reader(StringIO(line))))\n",
    "\n",
    "app_data_kv = app_data_rdd1.map(lambda x: (x[0], x))\n",
    "\n",
    "prev_data_kv = prev_data_rdd1.map(lambda x: (x[0], x))\n",
    "\n",
    "joined_rdd = app_data_kv.join(prev_data_kv)\n",
    "\n",
    "indexed_rdd = joined_rdd.zipWithIndex()\n",
    "\n",
    "element_at_0 = indexed_rdd.filter(lambda x: x[1] == 0).map(lambda x: x[0]).first()\n",
    "element_at_294368 = indexed_rdd.filter(lambda x: x[1] == 294368).map(lambda x: x[0]).first()\n",
    "\n",
    "filtered_rdd = indexed_rdd.filter(lambda x: x[1] != 0 and x[1] != 294368).map(lambda x: x[0])\n",
    "\n",
    "swapped_rdd = spark.sparkContext.parallelize([element_at_294368, element_at_0]) \\\n",
    "    .union(filtered_rdd)\n",
    "\n",
    "values_only_rdd = swapped_rdd.map(lambda x: x[1])\n",
    "flattened_rdd = values_only_rdd.map(lambda x: x[0] + x[1])\n",
    "\n",
    "\n",
    "\n",
    "mapping_dict = column_values_rdd.flatMap(lambda x: [((x[0], value[1]), value[0]) for value in x[1]]).collectAsMap()\n",
    "\n",
    "column_names = ['id_app', 'target', 'contract_type', 'gender', 'own_car', 'own_property', 'num_of_children', 'income_total', 'amt_credit', 'amt_annuity', 'amt_goods_price', 'income_type', 'education_type', 'family_status', 'housing_type', 'region_population', 'days_birth', 'days_employed', 'own_car_age', 'flag_mobile', 'flag_emp_phone', 'flag_work_phone', 'flag_cont_mobile', 'flag_phone', 'flag_email', 'occupation_type', 'cnt_fam_members', 'weekday_app_process_start', 'hour_app_process_start', 'organization_type', 'credit_score_1', 'credit_score_2', 'credit_score_3', 'days_last_phone_change', 'amt_credit_req_last_hour', 'amt_credit_req_last_day', 'amt_credit_req_last_week', 'amt_credit_req_last_month', 'amt_credit_req_last_quarter', 'amt_credit_req_last_year', 'id_app', 'contract_type', 'amt_annuity', 'amt_application', 'amt_credit', 'amt_down_payment', 'amt_goods_price', 'hour_appr_process_start', 'rate_down_payment', 'rate_interest_primary', 'rate_interest_privileged', 'name_cash_loan_purpose', 'name_contract_status', 'days_decision', 'name_payment_type', 'code_rejection_reason', 'name_type_suite', 'name_client_type', 'name_goods_category', 'name_portfolio', 'name_product_type', 'channel_type', 'sellerplace_area', 'name_seller_industry', 'cnt_payment', 'name_yield_group', 'product_combination', 'days_first_drawing', 'days_first_due', 'days_last_due_1st_version', 'days_last_due', 'days_termination', 'nflag_insured_on_approval', 'id']\n",
    "transformed_rdd = flattened_rdd.map(lambda row: [mapping_dict.get((column_names[i], row[i]), row[i]) for i in range(len(row))])\n",
    "\n",
    "selected_columns_rdd = transformed_rdd.map(lambda row: (row[0], row[6], row[7], row[13], row[44]))\n",
    "header = selected_columns_rdd.first()\n",
    "selected_columns_rdd1 = selected_columns_rdd.filter(lambda row: row != header)\n",
    "\n",
    "selected_columns_rdd2 = selected_columns_rdd1.filter(lambda row: int(row[1]) > 0 and row[3] == 'Married')\n",
    "\n",
    "selected_columns_rdd3 = selected_columns_rdd2.map(lambda x: (x[0], x))\n",
    "\n",
    "grouped_data = selected_columns_rdd3.reduceByKey(lambda x, y: (x[0],) + (x[1],) + (x[2],) + (x[3],) + (str(float(x[4]) + float(y[4])),))\n",
    "\n",
    "filtered_data = grouped_data.filter(lambda x: float(x[1][4]) > 5 * float(x[1][2]))\n",
    "\n",
    "ratio_rdd = filtered_data.map(lambda x: (x[1][0], x[1][1], x[1][2], x[1][3],x[1][4], float(x[1][4]) / float(x[1][2])))\n",
    "\n",
    "ratio_rdd1 = ratio_rdd.sortBy(lambda x: x[-1], ascending=False)\n",
    "\n",
    "ratio_rdd1.take(100)\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.2. DataFrame Implementation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+---------------+------------+-------------+------+-------------------+-------------------------+\n",
      "|id_app|num_of_children|income_total|family_status|id_app|  total_sum_per_app|Total_Credit/Income_Ratio|\n",
      "+------+---------------+------------+-------------+------+-------------------+-------------------------+\n",
      "|197725|              2|    144000.0|      Married|197725|        2.8667205E7|              199.0778125|\n",
      "|200698|              1|    126000.0|      Married|200698|       2.46144555E7|       195.35282142857142|\n",
      "|104007|              2|     72000.0|      Married|104007|       1.18949625E7|              165.2078125|\n",
      "|191956|              1|    112500.0|      Married|191956|       1.68350895E7|                149.64524|\n",
      "|270489|              1|    112428.0|      Married|270489|       1.56507525E7|       139.20689241114314|\n",
      "|164657|              1|     90000.0|      Married|164657|         1.181394E7|                  131.266|\n",
      "|193609|              1|    112500.0|      Married|193609|       1.42753005E7|                126.89156|\n",
      "|291238|              1|     90000.0|      Married|291238|        1.1088486E7|                 123.2054|\n",
      "|256557|              2|    157500.0|      Married|256557|       1.84593645E7|       117.20231428571428|\n",
      "|230165|              2|     90000.0|      Married|230165|       1.04614335E7|                116.23815|\n",
      "|110899|              1|    157500.0|      Married|110899|       1.75944285E7|       111.71065714285714|\n",
      "|107989|              1|    306000.0|      Married|107989|       3.24703035E7|       106.11210294117647|\n",
      "|132204|              1|    148500.0|      Married|132204|        1.5283242E7|       102.91745454545455|\n",
      "|148445|              1|     67500.0|      Married|148445|          6915298.5|       102.44886666666666|\n",
      "|192781|              3|    112500.0|      Married|192781|       1.11589515E7|                 99.19068|\n",
      "|183693|              1|    135000.0|      Married|183693|        1.3383711E7|                  99.1386|\n",
      "|245252|              1|    202500.0|      Married|245252|        1.9824759E7|        97.90004444444445|\n",
      "|133656|              2|    112500.0|      Married|133656|        1.0917801E7|                 97.04712|\n",
      "|114628|              2|     63000.0|      Married|114628|          6080701.5|        96.51907142857142|\n",
      "|128025|              1|    112500.0|      Married|128025|         1.085832E7|                  96.5184|\n",
      "|268811|              1|    180000.0|      Married|268811|       1.72853955E7|                96.029975|\n",
      "|288483|              1|    112500.0|      Married|288483|       1.05378615E7|                 93.66988|\n",
      "|128498|              1|    135000.0|      Married|128498|           1.2645E7|        93.66666666666667|\n",
      "|102217|              1|    117000.0|      Married|102217|       1.05495705E7|        90.16726923076924|\n",
      "|174637|              1|    270000.0|      Married|174637|       2.40488145E7|        89.06968333333333|\n",
      "|147884|              1|    180000.0|      Married|147884|       1.55823795E7|                86.568775|\n",
      "|263083|              2|     90000.0|      Married|263083|          7772251.5|                 86.35835|\n",
      "|268731|              2|     90000.0|      Married|268731|          7633804.5|                 84.82005|\n",
      "|144763|              1|    180000.0|      Married|144763|       1.51332435E7|                84.073575|\n",
      "|122312|              1|    135000.0|      Married|122312|       1.13280345E7|        83.91136666666667|\n",
      "|149258|              2|    225000.0|      Married|149258|       1.88406135E7|                 83.73606|\n",
      "|292185|              2|    211500.0|      Married|292185|        1.7114166E7|        80.91804255319148|\n",
      "|226624|              1|    112500.0|      Married|226624|      8988461.28125|        79.89743361111111|\n",
      "|219288|              1|    135000.0|      Married|219288|        1.0751859E7|                  79.6434|\n",
      "|137917|              1|    135000.0|      Married|137917|        1.0744245E7|                   79.587|\n",
      "|147915|              3|     72000.0|      Married|147915|          5684764.5|               78.9550625|\n",
      "|200310|              3|     90000.0|      Married|200310|          7056540.0|                   78.406|\n",
      "|275973|              2|    112500.0|      Married|275973|          8775585.0|                  78.0052|\n",
      "|124784|              1|    225000.0|      Married|124784|       1.74487995E7|                 77.55022|\n",
      "|112498|              1|    225000.0|      Married|112498|       1.73207295E7|                 76.98102|\n",
      "|160583|              1|    157500.0|      Married|160583|       1.20987495E7|        76.81745714285714|\n",
      "|117209|              1|    135000.0|      Married|117209|        1.0208763E7|        75.62046666666667|\n",
      "|138359|              1|     81000.0|      Married|138359|          6110739.0|        75.44122222222222|\n",
      "|296869|              1|    139500.0|      Married|296869|        1.0480752E7|        75.13083870967742|\n",
      "|235212|              1|     45000.0|      Married|235212|          3367729.5|        74.83843333333333|\n",
      "|252592|              1|    121500.0|      Married|252592|          9014611.5|        74.19433333333333|\n",
      "|209975|              2|    157500.0|      Married|209975|        1.1617839E7|        73.76405714285714|\n",
      "|123278|              1|    135000.0|      Married|123278|          9851521.5|        72.97423333333333|\n",
      "|173315|              2|     90000.0|      Married|173315|          6538855.5|                 72.65395|\n",
      "|269658|              1|    211500.0|      Married|269658|       1.52710065E7|        72.20334042553192|\n",
      "|254413|              2|    135000.0|      Married|254413|          9610740.0|        71.19066666666667|\n",
      "|290271|              1|    103500.0|      Married|290271|          7296894.0|        70.50139130434782|\n",
      "|193444|              1|    135000.0|      Married|193444|          9424831.5|        69.81356666666667|\n",
      "|147568|              1|     67500.0|      Married|147568|          4706523.0|        69.72626666666666|\n",
      "|298047|              1|    193500.0|      Married|298047|       1.34722575E7|        69.62406976744187|\n",
      "|201859|              1|    135000.0|      Married|201859|          9352507.5|        69.27783333333333|\n",
      "|116630|              2|     90000.0|      Married|116630|          6114415.5|                 67.93795|\n",
      "|217354|              1|     90000.0|      Married|217354|          6087906.0|                  67.6434|\n",
      "|149849|              1|    189000.0|      Married|149849|        1.2678876E7|                   67.084|\n",
      "|285652|              1|     81000.0|      Married|285652|          5415592.5|        66.85916666666667|\n",
      "|178554|              1|    103500.0|      Married|178554|         6879809.25|        66.47158695652173|\n",
      "|100122|              1|     76500.0|      Married|100122|          5045436.0|        65.95341176470588|\n",
      "|211517|              2|     90000.0|      Married|211517|          5927350.5|                 65.85945|\n",
      "|173219|              2|    135000.0|      Married|173219|          8877870.0|                   65.762|\n",
      "|208673|              1|    135000.0|      Married|208673|          8865319.5|        65.66903333333333|\n",
      "|198265|              1|     54000.0|      Married|198265|         3519474.75|        65.17545833333334|\n",
      "|131450|              1|    180000.0|      Married|131450|       1.17264195E7|                65.146775|\n",
      "|134961|              1|     67500.0|      Married|134961|          4379197.5|                   64.877|\n",
      "|255909|              2|    112500.0|      Married|255909|          7287300.0|                   64.776|\n",
      "|145843|              2|     94500.0|      Married|145843|    6098036.8515625|        64.52949049272486|\n",
      "|207446|              1|    315000.0|      Married|207446|       2.02290975E7|        64.21935714285715|\n",
      "|285976|              1|    135000.0|      Married|285976|          8610273.0|                  63.7798|\n",
      "|198096|              1|    157500.0|      Married|198096|     9964681.921875|       63.267821726190476|\n",
      "|221096|              1|     67500.0|      Married|221096|          4237906.5|                  62.7838|\n",
      "|149883|              2|    135000.0|      Married|149883|          8457880.5|        62.65096666666667|\n",
      "|228508|              1|     90000.0|      Married|228508|          5596578.0|                  62.1842|\n",
      "|193213|              2|     67500.0|      Married|193213|          4158454.5|        61.60673333333333|\n",
      "|263030|              1|    112500.0|      Married|263030|          6905088.0|                 61.37856|\n",
      "|236519|              1|    202500.0|      Married|236519|       1.24024635E7|        61.24673333333333|\n",
      "|115375|              1|    135000.0|      Married|115375|          8213850.0|       60.843333333333334|\n",
      "|149809|              2|     76500.0|      Married|149809|          4646038.5|        60.73252941176471|\n",
      "|221377|              1|    135000.0|      Married|221377|          8159472.0|       60.440533333333335|\n",
      "|281966|              1|    225000.0|      Married|281966|1.357904430078125E7|        60.35130800347222|\n",
      "|299603|              2|    112500.0|      Married|299603|          6785784.0|                 60.31808|\n",
      "|233676|              2|     67500.0|      Married|233676|          4023324.0|                  59.6048|\n",
      "|169921|              1|     47191.5|      Married|169921|          2810673.0|        59.55888242586059|\n",
      "|272297|              1|    135000.0|      Married|272297|          8033242.5|                  59.5055|\n",
      "|266003|              1|    112500.0|      Married|266003|          6690141.0|                 59.46792|\n",
      "|269374|              1|    144000.0|      Married|269374|          8439745.5|              58.60934375|\n",
      "|164041|              2|     85500.0|      Married|164041|          5005521.0|       58.544105263157896|\n",
      "|171049|              1|     90000.0|      Married|171049|          5262457.5|                 58.47175|\n",
      "|128388|              1|     90000.0|      Married|128388|          5256643.5|                 58.40715|\n",
      "|276017|              2|    108000.0|      Married|276017|          6305616.0|       58.385333333333335|\n",
      "|180458|              5|    135000.0|      Married|180458|          7865082.0|        58.25986666666667|\n",
      "|265883|              2|    351000.0|      Married|265883|       2.03568165E7|       57.996628205128204|\n",
      "|132210|              1|    135000.0|      Married|132210|          7828222.5|        57.98683333333334|\n",
      "|282489|              2|    112500.0|      Married|282489|          6511617.0|                 57.88104|\n",
      "|255496|              1|    225000.0|      Married|255496|       1.29951855E7|                 57.75638|\n",
      "|124884|              2|    180000.0|      Married|124884|        1.0378134E7|                  57.6563|\n",
      "|200161|              1|    112500.0|      Married|200161|          6473655.0|                  57.5436|\n",
      "+------+---------------+------------+-------------+------+-------------------+-------------------------+\n",
      "\n",
      "CPU times: user 12.3 ms, sys: 2.38 ms, total: 14.7 ms\n",
      "Wall time: 1.15 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "\n",
    "selected_columns = [df_app_data[0],df_app_data[6],df_app_data[7],df_app_data[13]]\n",
    "df_fam_income = df_app_data.select(selected_columns)\n",
    "\n",
    "family_status_rows = df_value_dict.filter(df_value_dict['category'] == 'family_status')\n",
    "selected_columns = [family_status_rows[2], family_status_rows[3]]\n",
    "df_selected = family_status_rows.select(selected_columns)\n",
    "\n",
    "df_fam_income1 = df_fam_income.join(df_selected,df_fam_income.family_status==df_selected.Value, how = 'inner')\n",
    "\n",
    "selected_columns = [df_fam_income1[0],df_fam_income1[1],df_fam_income1[2],df_fam_income1[4]]\n",
    "\n",
    "df_fam_income2 = df_fam_income1.select(selected_columns)\n",
    "\n",
    "df_fam_income2 = df_fam_income2.withColumnRenamed(df_fam_income2.columns[3], 'family_status')\n",
    "\n",
    "filtered_fam_income_df = df_fam_income2.filter(df_fam_income2['num_of_children'] > 0)\n",
    "\n",
    "filtered_fam_income_df1 = filtered_fam_income_df.filter(filtered_fam_income_df['family_status'] == \"Married\")\n",
    "\n",
    "selected_columns = [df_prev_data[0],df_prev_data[4]]\n",
    "\n",
    "df_credit_toal = df_prev_data.select(selected_columns)\n",
    "\n",
    "df_credit_grouped = df_credit_toal.groupBy('id_app').agg(F.sum('amt_credit').alias('total_sum_per_app'))\n",
    "\n",
    "df_combined = filtered_fam_income_df1.join(df_credit_grouped,filtered_fam_income_df1.id_app==df_credit_grouped.id_app, how = 'inner')\n",
    "\n",
    "df_combined = df_combined.filter(df_combined['total_sum_per_app'] > 5*df_combined['income_total'])\n",
    "\n",
    "df_combined = df_combined.withColumn(\"Total_Credit/Income_Ratio\", (df_combined['total_sum_per_app']/df_combined['income_total']) )\n",
    "\n",
    "df_combined = df_combined.orderBy(F.col(\"Total_Credit/Income_Ratio\"), ascending=False).limit(100)\n",
    "\n",
    "df_combined.show(100)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 3.3. Spark SQL Implementation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "+------+---------------+------------+-------+-------------------+-------------------------+\n",
      "|id_app|num_of_children|income_total|    Key|   total_amt_credit|Total_Credit/Income_Ratio|\n",
      "+------+---------------+------------+-------+-------------------+-------------------------+\n",
      "|197725|              2|    144000.0|Married|        2.8667205E7|              199.0778125|\n",
      "|200698|              1|    126000.0|Married|       2.46144555E7|       195.35282142857142|\n",
      "|104007|              2|     72000.0|Married|       1.18949625E7|              165.2078125|\n",
      "|191956|              1|    112500.0|Married|       1.68350895E7|                149.64524|\n",
      "|270489|              1|    112428.0|Married|       1.56507525E7|       139.20689241114314|\n",
      "|164657|              1|     90000.0|Married|         1.181394E7|                  131.266|\n",
      "|193609|              1|    112500.0|Married|       1.42753005E7|                126.89156|\n",
      "|291238|              1|     90000.0|Married|        1.1088486E7|                 123.2054|\n",
      "|256557|              2|    157500.0|Married|       1.84593645E7|       117.20231428571428|\n",
      "|230165|              2|     90000.0|Married|       1.04614335E7|                116.23815|\n",
      "|110899|              1|    157500.0|Married|       1.75944285E7|       111.71065714285714|\n",
      "|107989|              1|    306000.0|Married|       3.24703035E7|       106.11210294117647|\n",
      "|132204|              1|    148500.0|Married|        1.5283242E7|       102.91745454545455|\n",
      "|148445|              1|     67500.0|Married|          6915298.5|       102.44886666666666|\n",
      "|192781|              3|    112500.0|Married|       1.11589515E7|                 99.19068|\n",
      "|183693|              1|    135000.0|Married|        1.3383711E7|                  99.1386|\n",
      "|245252|              1|    202500.0|Married|        1.9824759E7|        97.90004444444445|\n",
      "|133656|              2|    112500.0|Married|        1.0917801E7|                 97.04712|\n",
      "|114628|              2|     63000.0|Married|          6080701.5|        96.51907142857142|\n",
      "|128025|              1|    112500.0|Married|         1.085832E7|                  96.5184|\n",
      "|268811|              1|    180000.0|Married|       1.72853955E7|                96.029975|\n",
      "|288483|              1|    112500.0|Married|       1.05378615E7|                 93.66988|\n",
      "|128498|              1|    135000.0|Married|           1.2645E7|        93.66666666666667|\n",
      "|102217|              1|    117000.0|Married|       1.05495705E7|        90.16726923076924|\n",
      "|174637|              1|    270000.0|Married|       2.40488145E7|        89.06968333333333|\n",
      "|147884|              1|    180000.0|Married|       1.55823795E7|                86.568775|\n",
      "|263083|              2|     90000.0|Married|          7772251.5|                 86.35835|\n",
      "|268731|              2|     90000.0|Married|          7633804.5|                 84.82005|\n",
      "|144763|              1|    180000.0|Married|       1.51332435E7|                84.073575|\n",
      "|122312|              1|    135000.0|Married|       1.13280345E7|        83.91136666666667|\n",
      "|149258|              2|    225000.0|Married|       1.88406135E7|                 83.73606|\n",
      "|292185|              2|    211500.0|Married|        1.7114166E7|        80.91804255319148|\n",
      "|226624|              1|    112500.0|Married|      8988461.28125|        79.89743361111111|\n",
      "|219288|              1|    135000.0|Married|        1.0751859E7|                  79.6434|\n",
      "|137917|              1|    135000.0|Married|        1.0744245E7|                   79.587|\n",
      "|147915|              3|     72000.0|Married|          5684764.5|               78.9550625|\n",
      "|200310|              3|     90000.0|Married|          7056540.0|                   78.406|\n",
      "|275973|              2|    112500.0|Married|          8775585.0|                  78.0052|\n",
      "|124784|              1|    225000.0|Married|       1.74487995E7|                 77.55022|\n",
      "|112498|              1|    225000.0|Married|       1.73207295E7|                 76.98102|\n",
      "|160583|              1|    157500.0|Married|       1.20987495E7|        76.81745714285714|\n",
      "|117209|              1|    135000.0|Married|        1.0208763E7|        75.62046666666667|\n",
      "|138359|              1|     81000.0|Married|          6110739.0|        75.44122222222222|\n",
      "|296869|              1|    139500.0|Married|        1.0480752E7|        75.13083870967742|\n",
      "|235212|              1|     45000.0|Married|          3367729.5|        74.83843333333333|\n",
      "|252592|              1|    121500.0|Married|          9014611.5|        74.19433333333333|\n",
      "|209975|              2|    157500.0|Married|        1.1617839E7|        73.76405714285714|\n",
      "|123278|              1|    135000.0|Married|          9851521.5|        72.97423333333333|\n",
      "|173315|              2|     90000.0|Married|          6538855.5|                 72.65395|\n",
      "|269658|              1|    211500.0|Married|       1.52710065E7|        72.20334042553192|\n",
      "|254413|              2|    135000.0|Married|          9610740.0|        71.19066666666667|\n",
      "|290271|              1|    103500.0|Married|          7296894.0|        70.50139130434782|\n",
      "|193444|              1|    135000.0|Married|          9424831.5|        69.81356666666667|\n",
      "|147568|              1|     67500.0|Married|          4706523.0|        69.72626666666666|\n",
      "|298047|              1|    193500.0|Married|       1.34722575E7|        69.62406976744187|\n",
      "|201859|              1|    135000.0|Married|          9352507.5|        69.27783333333333|\n",
      "|116630|              2|     90000.0|Married|          6114415.5|                 67.93795|\n",
      "|217354|              1|     90000.0|Married|          6087906.0|                  67.6434|\n",
      "|149849|              1|    189000.0|Married|        1.2678876E7|                   67.084|\n",
      "|285652|              1|     81000.0|Married|          5415592.5|        66.85916666666667|\n",
      "|178554|              1|    103500.0|Married|         6879809.25|        66.47158695652173|\n",
      "|100122|              1|     76500.0|Married|          5045436.0|        65.95341176470588|\n",
      "|211517|              2|     90000.0|Married|          5927350.5|                 65.85945|\n",
      "|173219|              2|    135000.0|Married|          8877870.0|                   65.762|\n",
      "|208673|              1|    135000.0|Married|          8865319.5|        65.66903333333333|\n",
      "|198265|              1|     54000.0|Married|         3519474.75|        65.17545833333334|\n",
      "|131450|              1|    180000.0|Married|       1.17264195E7|                65.146775|\n",
      "|134961|              1|     67500.0|Married|          4379197.5|                   64.877|\n",
      "|255909|              2|    112500.0|Married|          7287300.0|                   64.776|\n",
      "|145843|              2|     94500.0|Married|    6098036.8515625|        64.52949049272486|\n",
      "|207446|              1|    315000.0|Married|       2.02290975E7|        64.21935714285715|\n",
      "|285976|              1|    135000.0|Married|          8610273.0|                  63.7798|\n",
      "|198096|              1|    157500.0|Married|     9964681.921875|       63.267821726190476|\n",
      "|221096|              1|     67500.0|Married|          4237906.5|                  62.7838|\n",
      "|149883|              2|    135000.0|Married|          8457880.5|        62.65096666666667|\n",
      "|228508|              1|     90000.0|Married|          5596578.0|                  62.1842|\n",
      "|193213|              2|     67500.0|Married|          4158454.5|        61.60673333333333|\n",
      "|263030|              1|    112500.0|Married|          6905088.0|                 61.37856|\n",
      "|236519|              1|    202500.0|Married|       1.24024635E7|        61.24673333333333|\n",
      "|115375|              1|    135000.0|Married|          8213850.0|       60.843333333333334|\n",
      "|149809|              2|     76500.0|Married|          4646038.5|        60.73252941176471|\n",
      "|221377|              1|    135000.0|Married|          8159472.0|       60.440533333333335|\n",
      "|281966|              1|    225000.0|Married|1.357904430078125E7|        60.35130800347222|\n",
      "|299603|              2|    112500.0|Married|          6785784.0|                 60.31808|\n",
      "|233676|              2|     67500.0|Married|          4023324.0|                  59.6048|\n",
      "|169921|              1|     47191.5|Married|          2810673.0|        59.55888242586059|\n",
      "|272297|              1|    135000.0|Married|          8033242.5|                  59.5055|\n",
      "|266003|              1|    112500.0|Married|          6690141.0|                 59.46792|\n",
      "|269374|              1|    144000.0|Married|          8439745.5|              58.60934375|\n",
      "|164041|              2|     85500.0|Married|          5005521.0|       58.544105263157896|\n",
      "|171049|              1|     90000.0|Married|          5262457.5|                 58.47175|\n",
      "|128388|              1|     90000.0|Married|          5256643.5|                 58.40715|\n",
      "|276017|              2|    108000.0|Married|          6305616.0|       58.385333333333335|\n",
      "|180458|              5|    135000.0|Married|          7865082.0|        58.25986666666667|\n",
      "|265883|              2|    351000.0|Married|       2.03568165E7|       57.996628205128204|\n",
      "|132210|              1|    135000.0|Married|          7828222.5|        57.98683333333334|\n",
      "|282489|              2|    112500.0|Married|          6511617.0|                 57.88104|\n",
      "|255496|              1|    225000.0|Married|       1.29951855E7|                 57.75638|\n",
      "|124884|              2|    180000.0|Married|        1.0378134E7|                  57.6563|\n",
      "|200161|              1|    112500.0|Married|          6473655.0|                  57.5436|\n",
      "+------+---------------+------------+-------+-------------------+-------------------------+\n",
      "\n",
      "CPU times: user 1.4 ms, sys: 5.2 ms, total: 6.6 ms\n",
      "Wall time: 1.12 s\n"
     ]
    }
   ],
   "source": [
    "%%time \n",
    "\n",
    "df_app_data.createOrReplaceTempView(\"sql_app_data\")\n",
    "df_prev_data.createOrReplaceTempView(\"sql_prev_data\")\n",
    "df_value_dict.createOrReplaceTempView(\"sql_value_dict\")\n",
    "\n",
    "SQL_fam_income = spark.sql('''\n",
    "  SELECT AD.id_app, AD.num_of_children, AD.income_total, VD.Key, SUM(PD.amt_credit) AS total_amt_credit,SUM(PD.amt_credit)/AD.income_total AS `Total_Credit/Income_Ratio`\n",
    "  FROM sql_app_data as AD \n",
    "  INNER JOIN (Select Key, Value FROM sql_value_dict where category = 'family_status') AS VD\n",
    "  on AD.family_status = VD.Value\n",
    "  INNER JOIN(SELECT id_app, amt_credit FROM sql_prev_data) AS PD\n",
    "  on AD.id_app = PD.id_app\n",
    "  Where num_of_children > 0 and VD.Key = 'Married' \n",
    "  Group by AD.id_app, AD.num_of_children, AD.income_total, VD.Key\n",
    "  HAVING SUM(PD.amt_credit) > 5 * AD.income_total\n",
    "  Order by `Total_Credit/Income_Ratio` DESC\n",
    "  limit(100)\n",
    "    \n",
    "''')\n",
    "\n",
    "SQL_fam_income.show(100)\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3.4 Observe the query execution time among RDD, DataFrame, SparkSQL, which is the fastest and why? (Maximum 500 words.)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "SQL \n",
    "CPU times: user 1.4 ms, sys: 5.2 ms, total: 6.6 ms\n",
    "Wall time: 1.12 s\n",
    "\n",
    "Dataframe\n",
    "CPU times: user 12.3 ms, sys: 2.38 ms, total: 14.7 ms\n",
    "Wall time: 1.15 s\n",
    "\n",
    "RDD\n",
    "CPU times: user 69.3 ms, sys: 17.2 ms, total: 86.5 ms\n",
    "Wall time: 13 s\n",
    "\n",
    "\n",
    "In Apache Spark, the three main data abstractionsRDD, DataFrames, and SparkSQLserve different purposes and have different performance metrics. Understanding them can help you choose the right abstraction for your specific computing needs. \n",
    "\n",
    "RDD (Resilient Distributed Dataset): \n",
    "\n",
    "Performance: RDDs represent Spark's core data structure and provide low-level functionality and management. They refer to functional programming with less focus on data and structure. Checking this level is done at the expense of optimization. RDDs do not benefit from spark and advanced optimizations such as Catalyst Optimizer and Tungsten Execution Engine. \n",
    "Use Case: RDDs are ideal when fine-grained control over data and transformations is required, especially in scenarios involving complex process logic that cannot be easily expressed using SQL or DataFrame operations. \n",
    "Why slower? As noted, the longer execution times of RDDs are due to the lack of optimization engines, resulting in more user code execution and less optimized execution plans. \n",
    "DataFrame API: \n",
    "\n",
    "Performance: Spark's DataFrames provide a higher level of abstraction and are similar to relational databases, where data is organized into named columns. This abstraction allows Spark to manage and optimize the schema. \n",
    "use cases: These are particularly useful for structured data operations and use Spark's catalyst to efficiently optimize queries. \n",
    "Why Relatively Faster: DataFrames are faster than RDDs because of their optimization features. However, they can be slightly slower than SparkSQL, which may be due to the programming API used in DataFrames. \n",
    "SparkSQL: \n",
    "\n",
    "Performance: SparkSQL runs on the same engine as the DataFrame API, but allows logic to be expressed in SQL, providing a more compact and readable format for those familiar with SQL. \n",
    "Use Case: This abstraction is ideal for querying structured data and takes full advantage of the Catalyst Optimizer and Tungsten Execution Engine for query optimization. \n",
    "Why the fastest: SparkSQL queries show the fastest execution times for your observations thanks to highly optimized execution plans created by the Catalyst optimization tool. The declarative nature of SQL often leads to more efficient execution paths. \n",
    "\n",
    "The observed differences in execution times can be attributed to the level of abstraction and the extent of optimization each approach allows. RDDs, being the least abstract and the least optimized, are the slowest. DataFrames provide a balance between abstraction and control, with significant optimizations through Catalyst and Tungsten. SparkSQL, with its high level of abstraction and optimization, leads to the fastest execution in this comparison.\n",
    "\n",
    "In Spark, the choice between RDDs, DataFrames, and SparkSQL often depends on the specific requirements of the task, such as the need for fine-grained control, optimization, or ease of query formulation. The execution times you observed align well with the typical expectations from these different APIs in Spark's ecosystem."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Summary\n",
    "\n",
    "The time might differ when running on different machines. Overall, the DataFrame and SQL queries run faster  compared with RDD.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Some ideas on the comparison\n",
    "\n",
    "Armbrust, M., Huai, Y., Liang, C., Xin, R., & Zaharia, M. (2015). Deep Dive into Spark SQLs Catalyst Optimizer. Retrieved September 30, 2017, from https://databricks.com/blog/2015/04/13/deep-dive-into-spark-sqls-catalyst-optimizer.html\n",
    "\n",
    "Damji, J. (2016). A Tale of Three Apache Spark APIs: RDDs, DataFrames, and Datasets. Retrieved September 28, 2017, from https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html\n",
    "\n",
    "Data Flair (2017a). Apache Spark RDD vs DataFrame vs DataSet. Retrieved September 28, 2017, from http://data-flair.training/blogs/apache-spark-rdd-vs-dataframe-vs-dataset\n",
    "\n",
    "Prakash, C. (2016). Apache Spark: RDD vs Dataframe vs Dataset. Retrieved September 28, 2017, from http://why-not-learn-something.blogspot.com.au/2016/07/apache-spark-rdd-vs-dataframe-vs-dataset.html\n",
    "\n",
    "Xin, R., & Rosen, J. (2015). Project Tungsten: Bringing Apache Spark Closer to Bare Metal. Retrieved September 30, 2017, from https://databricks.com/blog/2015/04/28/project-tungsten-bringing-spark-closer-to-bare-metal.html"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
